"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([[99499],{75254:(t,e,i)=>{i.d(e,{ys:()=>K});var n=i(74075),r=i(91643);const s="undefined"!=typeof navigator&&!/Edge\/(\d+)/.exec(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor)&&(/Mobile\/\w+/.test(navigator.userAgent)||navigator.maxTouchPoints>2),o="-10000px";class l{constructor(t,e,i){this.facet=e,this.createTooltipView=i,this.input=t.state.facet(e),this.tooltips=this.input.filter((t=>t)),this.tooltipViews=this.tooltips.map(i)}update(t){let e=t.state.facet(this.facet),i=e.filter((t=>t));if(e===this.input){for(let e of this.tooltipViews)e.update&&e.update(t);return!1}let n=[];for(let e=0;e<i.length;e++){let r=i[e],s=-1;if(r){for(let t=0;t<this.tooltips.length;t++){let e=this.tooltips[t];e&&e.create==r.create&&(s=t)}if(s<0)n[e]=this.createTooltipView(r);else{let i=n[e]=this.tooltipViews[s];i.update&&i.update(t)}}}for(let t of this.tooltipViews)n.indexOf(t)<0&&t.dom.remove();return this.input=e,this.tooltips=i,this.tooltipViews=n,!0}}function a(){return{top:0,left:0,bottom:innerHeight,right:innerWidth}}const h=n.r$.define({combine:t=>{var e,i,n;return{position:s?"absolute":(null===(e=t.find((t=>t.position)))||void 0===e?void 0:e.position)||"fixed",parent:(null===(i=t.find((t=>t.parent)))||void 0===i?void 0:i.parent)||null,tooltipSpace:(null===(n=t.find((t=>t.tooltipSpace)))||void 0===n?void 0:n.tooltipSpace)||a}}}),c=r.lg.fromClass(class{constructor(t){var e;this.view=t,this.inView=!0,this.lastTransaction=0,this.measureTimeout=-1;let i=t.state.facet(h);this.position=i.position,this.parent=i.parent,this.classes=t.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.manager=new l(t,p,(t=>this.createTooltip(t))),this.intersectionObserver="function"==typeof IntersectionObserver?new IntersectionObserver((t=>{Date.now()>this.lastTransaction-50&&t.length>0&&t[t.length-1].intersectionRatio<1&&this.measureSoon()}),{threshold:[1]}):null,this.observeIntersection(),null===(e=t.dom.ownerDocument.defaultView)||void 0===e||e.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let t of this.manager.tooltipViews)this.intersectionObserver.observe(t.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout((()=>{this.measureTimeout=-1,this.maybeMeasure()}),50))}update(t){t.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(t);e&&this.observeIntersection();let i=e||t.geometryChanged,n=t.state.facet(h);if(n.position!=this.position){this.position=n.position;for(let t of this.manager.tooltipViews)t.dom.style.position=this.position;i=!0}if(n.parent!=this.parent){this.parent&&this.container.remove(),this.parent=n.parent,this.createContainer();for(let t of this.manager.tooltipViews)this.container.appendChild(t.dom);i=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);i&&this.maybeMeasure()}createTooltip(t){let e=t.create(this.view);if(e.dom.classList.add("cm-tooltip"),t.arrow&&!e.dom.querySelector("cm-tooltip > cm-tooltip-arrow")){let t=document.createElement("div");t.className="cm-tooltip-arrow",e.dom.appendChild(t)}return e.dom.style.position=this.position,e.dom.style.top=o,this.container.appendChild(e.dom),e.mount&&e.mount(this.view),e}destroy(){var t,e;null===(t=this.view.dom.ownerDocument.defaultView)||void 0===t||t.removeEventListener("resize",this.measureSoon);for(let{dom:t}of this.manager.tooltipViews)t.remove();null===(e=this.intersectionObserver)||void 0===e||e.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let t=this.view.dom.getBoundingClientRect();return{editor:t,parent:this.parent?this.container.getBoundingClientRect():t,pos:this.manager.tooltips.map((t=>this.view.coordsAtPos(t.pos))),size:this.manager.tooltipViews.map((({dom:t})=>t.getBoundingClientRect())),space:this.view.state.facet(h).tooltipSpace(this.view)}}writeMeasure(t){let{editor:e,space:i}=t,n=[];for(let s=0;s<this.manager.tooltips.length;s++){let l=this.manager.tooltips[s],a=this.manager.tooltipViews[s],{dom:h}=a,c=t.pos[s],u=t.size[s];if(!c||c.bottom<=Math.max(e.top,i.top)||c.top>=Math.min(e.bottom,i.bottom)||c.right<=Math.max(e.left,i.left)||c.left>=Math.min(e.right,i.right)){h.style.top=o;continue}let p=l.arrow?a.dom.querySelector(".cm-tooltip-arrow"):null,d=p?7:0,m=u.right-u.left,g=u.bottom-u.top,b=a.offset||f,v=this.view.textDirection==r.Nm.LTR,y=u.width>i.right-i.left?v?i.left:i.right-u.width:v?Math.min(c.left-(p?14:0)+b.x,i.right-m):Math.max(i.left,c.left-m+(p?14:0)-b.x),x=!!l.above;!l.strictSide&&(x?c.top-(u.bottom-u.top)-b.y<i.top:c.bottom+(u.bottom-u.top)+b.y>i.bottom)&&x==i.bottom-c.bottom>c.top-i.top&&(x=!x);let w=x?c.top-g-d-b.y:c.bottom+d+b.y,k=y+m;if(!0!==a.overlap)for(let t of n)t.left<k&&t.right>y&&t.top<w+g&&t.bottom>w&&(w=x?t.top-g-2-d:t.bottom+d+2);"absolute"==this.position?(h.style.top=w-t.parent.top+"px",h.style.left=y-t.parent.left+"px"):(h.style.top=w+"px",h.style.left=y+"px"),p&&(p.style.left=c.left+(v?b.x:-b.x)-(y+14-7)+"px"),!0!==a.overlap&&n.push({left:y,top:w,right:k,bottom:w+g}),h.classList.toggle("cm-tooltip-above",x),h.classList.toggle("cm-tooltip-below",!x),a.positioned&&a.positioned()}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let t of this.manager.tooltipViews)t.dom.style.top=o}},{eventHandlers:{scroll(){this.maybeMeasure()}}}),u=r.tk.baseTheme({".cm-tooltip":{zIndex:100},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:"14px",position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),f={x:0,y:0},p=n.r$.define({enables:[c,u]});var d=i(25070),m=i(51686);class g{constructor(t,e,i){this.state=t,this.pos=e,this.explicit=i,this.abortListeners=[]}tokenBefore(t){let e=(0,d.qz)(this.state).resolveInner(this.pos,-1);for(;e&&t.indexOf(e.name)<0;)e=e.parent;return e?{from:e.from,to:this.pos,text:this.state.sliceDoc(e.from,this.pos),type:e.type}:null}matchBefore(t){let e=this.state.doc.lineAt(this.pos),i=Math.max(e.from,this.pos-250),n=e.text.slice(i-e.from,this.pos-e.from),r=n.search(w(t,!1));return r<0?null:{from:i+r,to:this.pos,text:n.slice(r)}}get aborted(){return null==this.abortListeners}addEventListener(t,e){"abort"==t&&this.abortListeners&&this.abortListeners.push(e)}}function b(t){let e=Object.keys(t).join(""),i=/\w/.test(e);return i&&(e=e.replace(/\w/g,"")),`[${i?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function v(t){let e=t.map((t=>"string"==typeof t?{label:t}:t)),[i,n]=e.every((t=>/^\w+$/.test(t.label)))?[/\w*$/,/\w+$/]:function(t){let e=Object.create(null),i=Object.create(null);for(let{label:n}of t){e[n[0]]=!0;for(let t=1;t<n.length;t++)i[n[t]]=!0}let n=b(e)+b(i)+"*$";return[new RegExp("^"+n),new RegExp(n)]}(e);return t=>{let r=t.matchBefore(n);return r||t.explicit?{from:r?r.from:t.pos,options:e,span:i}:null}}class y{constructor(t,e,i){this.completion=t,this.source=e,this.match=i}}function x(t){return t.selection.main.head}function w(t,e){var i;let{source:n}=t,r=e&&"^"!=n[0],s="$"!=n[n.length-1];return r||s?new RegExp(`${r?"^":""}(?:${n})${s?"$":""}`,null!==(i=t.flags)&&void 0!==i?i:t.ignoreCase?"i":""):t}const k=n.q6.define();function C(t,e){let i=e.completion.apply||e.completion.label,n=e.source;"string"==typeof i?t.dispatch({changes:{from:n.from,to:n.to,insert:i},selection:{anchor:n.from+i.length},userEvent:"input.complete",annotations:k.of(e.completion)}):i(t,e.completion,n.from,n.to)}const S=new WeakMap;function A(t){if(!Array.isArray(t))return t;let e=S.get(t);return e||S.set(t,e=v(t)),e}class M{constructor(t){this.pattern=t,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[];for(let e=0;e<t.length;){let i=(0,m.gm)(t,e),n=(0,m.nZ)(i);this.chars.push(i);let r=t.slice(e,e+n),s=r.toUpperCase();this.folded.push((0,m.gm)(s==r?r.toLowerCase():s,0)),e+=n}this.astral=t.length!=this.chars.length}match(t){if(0==this.pattern.length)return[0];if(t.length<this.pattern.length)return null;let{chars:e,folded:i,any:n,precise:r,byWord:s}=this;if(1==e.length){let n=(0,m.gm)(t,0);return n==e[0]?[0,0,(0,m.nZ)(n)]:n==i[0]?[-200,0,(0,m.nZ)(n)]:null}let o=t.indexOf(this.pattern);if(0==o)return[0,0,this.pattern.length];let l=e.length,a=0;if(o<0){for(let r=0,s=Math.min(t.length,200);r<s&&a<l;){let s=(0,m.gm)(t,r);s!=e[a]&&s!=i[a]||(n[a++]=r),r+=(0,m.nZ)(s)}if(a<l)return null}let h=0,c=0,u=!1,f=0,p=-1,d=-1,g=/[a-z]/.test(t),b=!0;for(let n=0,a=Math.min(t.length,200),v=0;n<a&&c<l;){let a=(0,m.gm)(t,n);o<0&&(h<l&&a==e[h]&&(r[h++]=n),f<l&&(a==e[f]||a==i[f]?(0==f&&(p=n),d=n+1,f++):f=0));let y,x=a<255?a>=48&&a<=57||a>=97&&a<=122?2:a>=65&&a<=90?1:0:(y=(0,m.bg)(a))!=y.toLowerCase()?1:y!=y.toUpperCase()?2:0;(!n||1==x&&g||0==v&&0!=x)&&(e[c]==a||i[c]==a&&(u=!0)?s[c++]=n:s.length&&(b=!1)),v=x,n+=(0,m.nZ)(a)}return c==l&&0==s[0]&&b?this.result((u?-200:0)-100,s,t):f==l&&0==p?[-200-t.length,0,d]:o>-1?[-700-t.length,o,o+this.pattern.length]:f==l?[-900-t.length,p,d]:c==l?this.result((u?-200:0)-100-700+(b?0:-1100),s,t):2==e.length?null:this.result((n[0]?-700:0)-200-1100,n,t)}result(t,e,i){let n=[t-i.length],r=1;for(let t of e){let e=t+(this.astral?(0,m.nZ)((0,m.gm)(i,t)):1);r>1&&n[r-1]==t?n[r-1]=e:(n[r++]=t,n[r++]=e)}return n}}const T=n.r$.define({combine:t=>(0,n.BO)(t,{activateOnTyping:!0,override:null,maxRenderedOptions:100,defaultKeymap:!0,optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[]},{defaultKeymap:(t,e)=>t&&e,icons:(t,e)=>t&&e,optionClass:(t,e)=>i=>function(t,e){return t?e?t+" "+e:t:e}(t(i),e(i)),addToOptions:(t,e)=>t.concat(e)})});function P(t,e,i){if(t<=i)return{from:0,to:t};if(e<=t>>1){let t=Math.floor(e/i);return{from:t*i,to:(t+1)*i}}let n=Math.floor((t-e)/i);return{from:t-(n+1)*i,to:t-n*i}}class L{constructor(t,e){this.view=t,this.stateField=e,this.info=null,this.placeInfo={read:()=>this.measureInfo(),write:t=>this.positionInfo(t),key:this};let i=t.state.field(e),{options:n,selected:r}=i.open,s=t.state.facet(T);this.optionContent=function(t){let e=t.addToOptions.slice();return t.icons&&e.push({render(t){let e=document.createElement("div");return e.classList.add("cm-completionIcon"),t.type&&e.classList.add(...t.type.split(/\s+/g).map((t=>"cm-completionIcon-"+t))),e.setAttribute("aria-hidden","true"),e},position:20}),e.push({render(t,e,i){let n=document.createElement("span");n.className="cm-completionLabel";let{label:r}=t,s=0;for(let t=1;t<i.length;){let e=i[t++],o=i[t++];e>s&&n.appendChild(document.createTextNode(r.slice(s,e)));let l=n.appendChild(document.createElement("span"));l.appendChild(document.createTextNode(r.slice(e,o))),l.className="cm-completionMatchedText",s=o}return s<r.length&&n.appendChild(document.createTextNode(r.slice(s))),n},position:50},{render(t){if(!t.detail)return null;let e=document.createElement("span");return e.className="cm-completionDetail",e.textContent=t.detail,e},position:80}),e.sort(((t,e)=>t.position-e.position)).map((t=>t.render))}(s),this.optionClass=s.optionClass,this.range=P(n.length,r,s.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.dom.addEventListener("mousedown",(e=>{for(let i,r=e.target;r&&r!=this.dom;r=r.parentNode)if("LI"==r.nodeName&&(i=/-(\d+)$/.exec(r.id))&&+i[1]<n.length)return C(t,n[+i[1]]),void e.preventDefault()})),this.list=this.dom.appendChild(this.createListBox(n,i.id,this.range)),this.list.addEventListener("scroll",(()=>{this.info&&this.view.requestMeasure(this.placeInfo)}))}mount(){this.updateSel()}update(t){t.state.field(this.stateField)!=t.startState.field(this.stateField)&&this.updateSel()}positioned(){this.info&&this.view.requestMeasure(this.placeInfo)}updateSel(){let t=this.view.state.field(this.stateField),e=t.open;if((e.selected<this.range.from||e.selected>=this.range.to)&&(this.range=P(e.options.length,e.selected,this.view.state.facet(T).maxRenderedOptions),this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e.options,t.id,this.range)),this.list.addEventListener("scroll",(()=>{this.info&&this.view.requestMeasure(this.placeInfo)}))),this.updateSelectedOption(e.selected)){this.info&&(this.info.remove(),this.info=null);let t=e.options[e.selected];t.completion.info&&(this.info=this.dom.appendChild(function(t,e){let i=document.createElement("div");i.className="cm-tooltip cm-completionInfo";let{info:n}=t.completion;if("string"==typeof n)i.textContent=n;else{let s=n(t.completion);s.then?s.then((t=>i.appendChild(t)),(t=>(0,r.OO)(e.state,t,"completion info"))):i.appendChild(s)}return i}(t,this.view)),this.view.requestMeasure(this.placeInfo))}}updateSelectedOption(t){let e=null;for(let i=this.list.firstChild,n=this.range.from;i;i=i.nextSibling,n++)n==t?i.hasAttribute("aria-selected")||(i.setAttribute("aria-selected","true"),e=i):i.hasAttribute("aria-selected")&&i.removeAttribute("aria-selected");return e&&function(t,e){let i=t.getBoundingClientRect(),n=e.getBoundingClientRect();n.top<i.top?t.scrollTop-=i.top-n.top:n.bottom>i.bottom&&(t.scrollTop+=n.bottom-i.bottom)}(this.list,e),e}measureInfo(){let t=this.dom.querySelector("[aria-selected]");if(!t||!this.info)return null;let e=this.dom.getBoundingClientRect(),i=this.info.getBoundingClientRect(),n=t.getBoundingClientRect();if(n.top>Math.min(innerHeight,e.bottom)-10||n.bottom<Math.max(0,e.top)+10)return null;let s=Math.max(0,Math.min(n.top,innerHeight-i.height))-e.top,o=this.view.textDirection==r.Nm.RTL,l=e.left,a=innerWidth-e.right;return o&&l<Math.min(i.width,a)?o=!1:!o&&a<Math.min(i.width,l)&&(o=!0),{top:s,left:o}}positionInfo(t){this.info&&(this.info.style.top=(t?t.top:-1e6)+"px",t&&(this.info.classList.toggle("cm-completionInfo-left",t.left),this.info.classList.toggle("cm-completionInfo-right",!t.left)))}createListBox(t,e,i){const n=document.createElement("ul");n.id=e,n.setAttribute("role","listbox");for(let r=i.from;r<i.to;r++){let{completion:i,match:s}=t[r];const o=n.appendChild(document.createElement("li"));o.id=e+"-"+r,o.setAttribute("role","option");let l=this.optionClass(i);l&&(o.className=l);for(let t of this.optionContent){let e=t(i,this.view.state,s);e&&o.appendChild(e)}}return i.from&&n.classList.add("cm-completionListIncompleteTop"),i.to<t.length&&n.classList.add("cm-completionListIncompleteBottom"),n}}function O(t){return 100*(t.boost||0)+(t.apply?10:0)+(t.info?5:0)+(t.type?1:0)}class B{constructor(t,e,i,n,r){this.options=t,this.attrs=e,this.tooltip=i,this.timestamp=n,this.selected=r}setSelected(t,e){return t==this.selected||t>=this.options.length?this:new B(this.options,E(e,t),this.tooltip,this.timestamp,t)}static build(t,e,i,n,r){let s=function(t,e){let i=[],n=0;for(let r of t)if(r.hasResult())if(!1===r.result.filter)for(let t of r.result.options)i.push(new y(t,r,[1e9-n++]));else{let t,n=new M(e.sliceDoc(r.from,r.to));for(let e of r.result.options)(t=n.match(e.label))&&(null!=e.boost&&(t[0]+=e.boost),i.push(new y(e,r,t)))}i.sort(I);let r=[],s=null;for(let t of i.sort(I)){if(300==r.length)break;s&&s.label==t.completion.label&&s.detail==t.completion.detail&&s.type==t.completion.type&&s.apply==t.completion.apply?O(t.completion)>O(s)&&(r[r.length-1]=t):r.push(t),s=t.completion}return r}(t,e);if(!s.length)return null;let o=0;if(n&&n.selected){let t=n.options[n.selected].completion;for(let e=0;e<s.length&&!o;e++)s[e].completion==t&&(o=e)}return new B(s,E(i,o),{pos:t.reduce(((t,e)=>e.hasResult()?Math.min(t,e.from):t),1e8),create:(l=W,t=>new L(t,l)),above:r.aboveCursor},n?n.timestamp:Date.now(),o);var l}map(t){return new B(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:t.mapPos(this.tooltip.pos)}),this.timestamp,this.selected)}}class D{constructor(t,e,i){this.active=t,this.id=e,this.open=i}static start(){return new D(R,"cm-ac-"+Math.floor(2e6*Math.random()).toString(36),null)}update(t){let{state:e}=t,i=e.facet(T),n=(i.override||e.languageDataAt("autocomplete",x(e)).map(A)).map((e=>(this.active.find((t=>t.source==e))||new j(e,this.active.some((t=>0!=t.state))?1:0)).update(t,i)));n.length==this.active.length&&n.every(((t,e)=>t==this.active[e]))&&(n=this.active);let r=t.selection||n.some((e=>e.hasResult()&&t.changes.touchesRange(e.from,e.to)))||!function(t,e){if(t==e)return!0;for(let i=0,n=0;;){for(;i<t.length&&!t[i].hasResult;)i++;for(;n<e.length&&!e[n].hasResult;)n++;let r=i==t.length,s=n==e.length;if(r||s)return r==s;if(t[i++].result!=e[n++].result)return!1}}(n,this.active)?B.build(n,e,this.id,this.open,i):this.open&&t.docChanged?this.open.map(t.changes):this.open;!r&&n.every((t=>1!=t.state))&&n.some((t=>t.hasResult()))&&(n=n.map((t=>t.hasResult()?new j(t.source,0):t)));for(let e of t.effects)e.is(F)&&(r=r&&r.setSelected(e.value,this.id));return n==this.active&&r==this.open?this:new D(n,this.id,r)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:N}}const N={"aria-autocomplete":"list","aria-expanded":"false"};function E(t,e){return{"aria-autocomplete":"list","aria-expanded":"true","aria-activedescendant":t+"-"+e,"aria-controls":t}}const R=[];function I(t,e){let i=e.match[0]-t.match[0];return i||t.completion.label.localeCompare(e.completion.label)}function q(t){return t.isUserEvent("input.type")?"input":t.isUserEvent("delete.backward")?"delete":null}class j{constructor(t,e,i=-1){this.source=t,this.state=e,this.explicitPos=i}hasResult(){return!1}update(t,e){let i=q(t),n=this;i?n=n.handleUserEvent(t,i,e):t.docChanged?n=n.handleChange(t):t.selection&&0!=n.state&&(n=new j(n.source,0));for(let e of t.effects)if(e.is(_))n=new j(n.source,1,e.value?x(t.state):-1);else if(e.is(V))n=new j(n.source,0);else if(e.is($))for(let t of e.value)t.source==n.source&&(n=t);return n}handleUserEvent(t,e,i){return"delete"!=e&&i.activateOnTyping?new j(this.source,1):this.map(t.changes)}handleChange(t){return t.changes.touchesRange(x(t.startState))?new j(this.source,0):this.map(t.changes)}map(t){return t.empty||this.explicitPos<0?this:new j(this.source,this.state,t.mapPos(this.explicitPos))}}class z extends j{constructor(t,e,i,n,r,s){super(t,2,e),this.result=i,this.from=n,this.to=r,this.span=s}hasResult(){return!0}handleUserEvent(t,e,i){let n=t.changes.mapPos(this.from),r=t.changes.mapPos(this.to,1),s=x(t.state);if((this.explicitPos>-1?s<n:s<=n)||s>r)return new j(this.source,"input"==e&&i.activateOnTyping?1:0);let o=this.explicitPos<0?-1:t.changes.mapPos(this.explicitPos);return this.span&&(n==r||this.span.test(t.state.sliceDoc(n,r)))?new z(this.source,o,this.result,n,r,this.span):new j(this.source,1,o)}handleChange(t){return t.changes.touchesRange(this.from,this.to)?new j(this.source,0):this.map(t.changes)}map(t){return t.empty?this:new z(this.source,this.explicitPos<0?-1:t.mapPos(this.explicitPos),this.result,t.mapPos(this.from),t.mapPos(this.to,1),this.span)}}const _=n.Py.define(),V=n.Py.define(),$=n.Py.define({map:(t,e)=>t.map((t=>t.map(e)))}),F=n.Py.define(),W=n.QQ.define({create:()=>D.start(),update:(t,e)=>t.update(e),provide:t=>[p.from(t,(t=>t.tooltip)),r.tk.contentAttributes.from(t,(t=>t.attrs))]});function U(t,e="option"){return i=>{let n=i.state.field(W,!1);if(!n||!n.open||Date.now()-n.open.timestamp<75)return!1;let r,s=1;"page"==e&&(r=function(t,e){let i=t.plugin(c);if(!i)return null;let n=i.manager.tooltips.indexOf(e);return n<0?null:i.manager.tooltipViews[n]}(i,n.open.tooltip))&&(s=Math.max(2,Math.floor(r.dom.offsetHeight/r.dom.querySelector("li").offsetHeight)-1));let o=n.open.selected+s*(t?1:-1),{length:l}=n.open.options;return o<0?o="page"==e?0:l-1:o>=l&&(o="page"==e?l-1:0),i.dispatch({effects:F.of(o)}),!0}}class H{constructor(t,e){this.active=t,this.context=e,this.time=Date.now(),this.updates=[],this.done=void 0}}const G=r.lg.fromClass(class{constructor(t){this.view=t,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.composing=0;for(let e of t.state.field(W).active)1==e.state&&this.startQuery(e)}update(t){let e=t.state.field(W);if(!t.selectionSet&&!t.docChanged&&t.startState.field(W)==e)return;let i=t.transactions.some((t=>(t.selection||t.docChanged)&&!q(t)));for(let e=0;e<this.running.length;e++){let n=this.running[e];if(i||n.updates.length+t.transactions.length>50&&n.time-Date.now()>1e3){for(let t of n.context.abortListeners)try{t()}catch(t){(0,r.OO)(this.view.state,t)}n.context.abortListeners=null,this.running.splice(e--,1)}else n.updates.push(...t.transactions)}if(this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),this.debounceUpdate=e.active.some((t=>1==t.state&&!this.running.some((e=>e.active.source==t.source))))?setTimeout((()=>this.startUpdate()),50):-1,0!=this.composing)for(let e of t.transactions)"input"==q(e)?this.composing=2:2==this.composing&&e.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1;let{state:t}=this.view,e=t.field(W);for(let t of e.active)1!=t.state||this.running.some((e=>e.active.source==t.source))||this.startQuery(t)}startQuery(t){let{state:e}=this.view,i=x(e),n=new g(e,i,t.explicitPos==i),s=new H(t,n);this.running.push(s),Promise.resolve(t.source(n)).then((t=>{s.context.aborted||(s.done=t||null,this.scheduleAccept())}),(t=>{this.view.dispatch({effects:V.of(null)}),(0,r.OO)(this.view.state,t)}))}scheduleAccept(){this.running.every((t=>void 0!==t.done))?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout((()=>this.accept()),50))}accept(){var t;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],i=this.view.state.facet(T);for(let n=0;n<this.running.length;n++){let r=this.running[n];if(void 0===r.done)continue;if(this.running.splice(n--,1),r.done){let n=new z(r.active.source,r.active.explicitPos,r.done,r.done.from,null!==(t=r.done.to)&&void 0!==t?t:x(r.updates.length?r.updates[0].startState:this.view.state),r.done.span&&!1!==r.done.filter?w(r.done.span,!0):null);for(let t of r.updates)n=n.update(t,i);if(n.hasResult()){e.push(n);continue}}let s=this.view.state.field(W).active.find((t=>t.source==r.active.source));if(s&&1==s.state)if(null==r.done){let t=new j(r.active.source,0);for(let e of r.updates)t=t.update(e,i);1!=t.state&&e.push(t)}else this.startQuery(s)}e.length&&this.view.dispatch({effects:$.of(e)})}},{eventHandlers:{compositionstart(){this.composing=1},compositionend(){3==this.composing&&setTimeout((()=>this.view.dispatch({effects:_.of(!1)})),20),this.composing=0}}}),Q=r.tk.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",listStyle:"none",margin:0,padding:0,"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer",padding:"1px 3px",lineHeight:1.2}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"···"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"300px"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'ƒ'"}},".cm-completionIcon-class":{"&:after":{content:"'○'"}},".cm-completionIcon-interface":{"&:after":{content:"'◌'"}},".cm-completionIcon-variable":{"&:after":{content:"'𝑥'"}},".cm-completionIcon-constant":{"&:after":{content:"'𝐶'"}},".cm-completionIcon-type":{"&:after":{content:"'𝑡'"}},".cm-completionIcon-enum":{"&:after":{content:"'∪'"}},".cm-completionIcon-property":{"&:after":{content:"'□'"}},".cm-completionIcon-keyword":{"&:after":{content:"'🔑︎'"}},".cm-completionIcon-namespace":{"&:after":{content:"'▢'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});function K(t={}){return[W,T.of(t),G,Z,Q]}const J=[{key:"Ctrl-Space",run:t=>!!t.state.field(W,!1)&&(t.dispatch({effects:_.of(!0)}),!0)},{key:"Escape",run:t=>{let e=t.state.field(W,!1);return!(!e||!e.active.some((t=>0!=t.state)))&&(t.dispatch({effects:V.of(null)}),!0)}},{key:"ArrowDown",run:U(!0)},{key:"ArrowUp",run:U(!1)},{key:"PageDown",run:U(!0,"page")},{key:"PageUp",run:U(!1,"page")},{key:"Enter",run:t=>{let e=t.state.field(W,!1);return!(t.state.readOnly||!e||!e.open||Date.now()-e.open.timestamp<75)&&(C(t,e.open.options[e.open.selected]),!0)}}],Z=n.Wl.highest(r.$f.computeN([T],(t=>t.facet(T).defaultKeymap?[J]:[])))},80508:(t,e,i)=>{i.d(e,{wQ:()=>ct,xi:()=>ht,at:()=>at});var n=i(74075),r=i(51686),s=i(91643),o=i(25070),l=i(97248);const a="()[]{}";function h(t,e,i){let n=t.prop(e<0?l.md.openedBy:l.md.closedBy);if(n)return n;if(1==t.name.length){let n=i.indexOf(t.name);if(n>-1&&n%2==(e<0?1:0))return[i[n+e]]}return null}function c(t,e,i,n={}){let r,s=n.maxScanDistance||1e4,l=n.brackets||a,c=(0,o.qz)(t),u=c.resolve(e,i);return(r=h(u.type,i,l))?function(t,e,i,n,r,s){let o=n.parent,l={from:n.from,to:n.to},a=0,c=null==o?void 0:o.cursor;if(c&&(i<0?c.childBefore(n.from):c.childAfter(n.to)))do{if(i<0?c.to<=n.from:c.from>=n.to){if(0==a&&r.indexOf(c.type.name)>-1)return{start:l,end:{from:c.from,to:c.to},matched:!0};if(h(c.type,i,s))a++;else if(h(c.type,-i,s)&&(a--,0==a))return{start:l,end:{from:c.from,to:c.to},matched:!1}}}while(i<0?c.prevSibling():c.nextSibling());return{start:l,matched:!1}}(0,0,i,u,r,l):function(t,e,i,n,r,s,o){let l=i<0?t.sliceDoc(e-1,e):t.sliceDoc(e,e+1),a=o.indexOf(l);if(a<0||a%2==0!=i>0)return null;let h={from:i<0?e-1:e,to:i>0?e+1:e},c=t.doc.iterRange(e,i>0?t.doc.length:0),u=0;for(let t=0;!c.next().done&&t<=s;){let s=c.value;i<0&&(t+=s.length);let l=e+t*i;for(let t=i>0?0:s.length-1,e=i>0?s.length:-1;t!=e;t+=i){let e=o.indexOf(s[t]);if(!(e<0||n.resolve(l+t,1).type!=r))if(e%2==0==i>0)u++;else{if(1==u)return{start:h,end:{from:l+t,to:l+t+1},matched:e>>1==a>>1};u--}}i>0&&(t+=s.length)}return c.done?{start:h,matched:!1}:null}(t,e,i,c,u.type,s,l)}function u(t,e){return n.jT.create(t.ranges.map(e),t.mainIndex)}function f(t,e){return t.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function p({state:t,dispatch:e},i){let n=u(t.selection,i);return!n.eq(t.selection)&&(e(f(t,n)),!0)}function d(t,e){return n.jT.cursor(e?t.to:t.from)}function m(t,e){return p(t,(i=>i.empty?t.moveByChar(i,e):d(i,e)))}const g=t=>m(t,t.textDirection!=s.Nm.LTR),b=t=>m(t,t.textDirection==s.Nm.LTR);function v(t,e){return p(t,(i=>i.empty?t.moveByGroup(i,e):d(i,e)))}function y(t,e,i){if(e.type.prop(i))return!0;let n=e.to-e.from;return n&&(n>2||/[^\s,.;:]/.test(t.sliceDoc(e.from,e.to)))||e.firstChild}function x(t,e,i){let r,s,a=(0,o.qz)(t).resolveInner(e.head),h=i?l.md.closedBy:l.md.openedBy;for(let n=e.head;;){let e=i?a.childAfter(n):a.childBefore(n);if(!e)break;y(t,e,h)?a=e:n=i?e.to:e.from}return s=a.type.prop(h)&&(r=i?c(t,a.from,1):c(t,a.to,-1))&&r.matched?i?r.end.to:r.end.from:i?a.to:a.from,n.jT.cursor(s,i?-1:1)}function w(t,e){return p(t,(i=>{if(!i.empty)return d(i,e);let n=t.moveVertically(i,e);return n.head!=i.head?n:t.moveToLineBoundary(i,e)}))}const k=t=>w(t,!1),C=t=>w(t,!0);function S(t,e){let{state:i}=t,n=u(i.selection,(i=>i.empty?t.moveVertically(i,e,t.dom.clientHeight):d(i,e)));if(n.eq(i.selection))return!1;let r=t.coordsAtPos(i.selection.main.head),o=t.scrollDOM.getBoundingClientRect();return t.dispatch(f(i,n),{effects:r&&r.top>o.top&&r.bottom<o.bottom?s.tk.scrollIntoView(n.main.head,{y:"start",yMargin:r.top-o.top}):void 0}),!0}const A=t=>S(t,!1),M=t=>S(t,!0);function T(t,e,i){let r=t.lineBlockAt(e.head),s=t.moveToLineBoundary(e,i);if(s.head==e.head&&s.head!=(i?r.to:r.from)&&(s=t.moveToLineBoundary(e,i,!1)),!i&&s.head==r.from&&r.length){let i=/^\s*/.exec(t.state.sliceDoc(r.from,Math.min(r.from+100,r.to)))[0].length;i&&e.head!=r.from+i&&(s=n.jT.cursor(r.from+i))}return s}const P=t=>p(t,(e=>T(t,e,!0))),L=t=>p(t,(e=>T(t,e,!1)));function O(t,e,i){let r=!1,s=u(t.selection,(e=>{let s=c(t,e.head,-1)||c(t,e.head,1)||e.head>0&&c(t,e.head-1,1)||e.head<t.doc.length&&c(t,e.head+1,-1);if(!s||!s.end)return e;r=!0;let o=s.start.from==e.head?s.end.to:s.end.from;return i?n.jT.range(e.anchor,o):n.jT.cursor(o)}));return!!r&&(e(f(t,s)),!0)}function B(t,e){let i=u(t.state.selection,(t=>{let i=e(t);return n.jT.range(t.anchor,i.head,i.goalColumn)}));return!i.eq(t.state.selection)&&(t.dispatch(f(t.state,i)),!0)}function D(t,e){return B(t,(i=>t.moveByChar(i,e)))}const N=t=>D(t,t.textDirection!=s.Nm.LTR),E=t=>D(t,t.textDirection==s.Nm.LTR);function R(t,e){return B(t,(i=>t.moveByGroup(i,e)))}function I(t,e){return B(t,(i=>t.moveVertically(i,e)))}const q=t=>I(t,!1),j=t=>I(t,!0);function z(t,e){return B(t,(i=>t.moveVertically(i,e,t.dom.clientHeight)))}const _=t=>z(t,!1),V=t=>z(t,!0),$=t=>B(t,(e=>T(t,e,!0))),F=t=>B(t,(e=>T(t,e,!1))),W=({state:t,dispatch:e})=>(e(f(t,{anchor:0})),!0),U=({state:t,dispatch:e})=>(e(f(t,{anchor:t.doc.length})),!0),H=({state:t,dispatch:e})=>(e(f(t,{anchor:t.selection.main.anchor,head:0})),!0),G=({state:t,dispatch:e})=>(e(f(t,{anchor:t.selection.main.anchor,head:t.doc.length})),!0);function Q({state:t,dispatch:e},i){if(t.readOnly)return!1;let r="delete.selection",s=t.changeByRange((t=>{let{from:e,to:s}=t;if(e==s){let t=i(e);t<e?r="delete.backward":t>e&&(r="delete.forward"),e=Math.min(e,t),s=Math.max(s,t)}return e==s?{range:t}:{changes:{from:e,to:s},range:n.jT.cursor(e)}}));return!s.changes.empty&&(e(t.update(s,{scrollIntoView:!0,userEvent:r})),!0)}function K(t,e,i){if(t instanceof s.tk)for(let n of t.pluginField(s.BF.atomicRanges))n.between(e,e,((t,n)=>{t<e&&n>e&&(e=i?n:t)}));return e}const J=(t,e)=>Q(t,(i=>{let n,s,{state:l}=t,a=l.doc.lineAt(i);if(!e&&i>a.from&&i<a.from+200&&!/[^ \t]/.test(n=a.text.slice(0,i-a.from))){if("\t"==n[n.length-1])return i-1;let t=(0,r.IS)(n,l.tabSize)%(0,o.y1)(l)||(0,o.y1)(l);for(let e=0;e<t&&" "==n[n.length-1-e];e++)i--;s=i}else s=(0,r.cp)(a.text,i-a.from,e,e)+a.from,s==i&&a.number!=(e?l.doc.lines:1)&&(s+=e?1:-1);return K(t,s,e)})),Z=t=>J(t,!1),X=t=>J(t,!0),Y=(t,e)=>Q(t,(i=>{let n=i,{state:s}=t,o=s.doc.lineAt(n),l=s.charCategorizer(n);for(let t=null;;){if(n==(e?o.to:o.from)){n==i&&o.number!=(e?s.doc.lines:1)&&(n+=e?1:-1);break}let a=(0,r.cp)(o.text,n-o.from,e)+o.from,h=o.text.slice(Math.min(n,a)-o.from,Math.max(n,a)-o.from),c=l(h);if(null!=t&&c!=t)break;" "==h&&n==i||(t=c),n=a}return K(t,n,e)})),tt=t=>Y(t,!1),et=t=>Q(t,(e=>{let i=t.lineBlockAt(e).to;return K(t,e<i?i:Math.min(t.state.doc.length,e+1),!0)}));function it(t){let e=[],i=-1;for(let n of t.selection.ranges){let r=t.doc.lineAt(n.from),s=t.doc.lineAt(n.to);if(n.empty||n.to!=s.from||(s=t.doc.lineAt(n.to-1)),i>=r.number){let t=e[e.length-1];t.to=s.to,t.ranges.push(n)}else e.push({from:r.from,to:s.to,ranges:[n]});i=s.number+1}return e}function nt(t,e,i){if(t.readOnly)return!1;let r=[],s=[];for(let e of it(t)){if(i?e.to==t.doc.length:0==e.from)continue;let o=t.doc.lineAt(i?e.to+1:e.from-1),l=o.length+1;if(i){r.push({from:e.to,to:o.to},{from:e.from,insert:o.text+t.lineBreak});for(let i of e.ranges)s.push(n.jT.range(Math.min(t.doc.length,i.anchor+l),Math.min(t.doc.length,i.head+l)))}else{r.push({from:o.from,to:e.from},{from:e.to,insert:t.lineBreak+o.text});for(let t of e.ranges)s.push(n.jT.range(t.anchor-l,t.head-l))}}return!!r.length&&(e(t.update({changes:r,scrollIntoView:!0,selection:n.jT.create(s,t.selection.mainIndex),userEvent:"move.line"})),!0)}function rt(t,e,i){if(t.readOnly)return!1;let n=[];for(let e of it(t))i?n.push({from:e.from,insert:t.doc.slice(e.from,e.to)+t.lineBreak}):n.push({from:e.to,insert:t.lineBreak+t.doc.slice(e.from,e.to)});return e(t.update({changes:n,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const st=ot(!1);function ot(t){return({state:e,dispatch:i})=>{if(e.readOnly)return!1;let s=e.changeByRange((i=>{let{from:s,to:a}=i,h=e.doc.lineAt(s),c=!t&&s==a&&function(t,e){if(/\(\)|\[\]|\{\}/.test(t.sliceDoc(e-1,e+1)))return{from:e,to:e};let i,n=(0,o.qz)(t).resolveInner(e),r=n.childBefore(e),s=n.childAfter(e);return r&&s&&r.to<=e&&s.from>=e&&(i=r.type.prop(l.md.closedBy))&&i.indexOf(s.name)>-1&&t.doc.lineAt(r.to).from==t.doc.lineAt(s.from).from?{from:r.to,to:s.from}:null}(e,s);t&&(s=a=(a<=h.to?h:e.doc.lineAt(a)).to);let u=new o.Gn(e,{simulateBreak:s,simulateDoubleBreak:!!c}),f=(0,o.K0)(u,s);for(null==f&&(f=/^\s*/.exec(e.doc.lineAt(s).text)[0].length);a<h.to&&/\s/.test(h.text[a-h.from]);)a++;c?({from:s,to:a}=c):s>h.from&&s<h.from+100&&!/\S/.test(h.text.slice(0,s))&&(s=h.from);let p=["",(0,o.SS)(e,f)];return c&&p.push((0,o.SS)(e,u.lineIndent(h.from,-1))),{changes:{from:s,to:a,insert:r.xv.of(p)},range:n.jT.cursor(s+1+p[1].length)}}));return i(e.update(s,{scrollIntoView:!0,userEvent:"input"})),!0}}function lt(t,e){let i=-1;return t.changeByRange((r=>{let s=[];for(let n=r.from;n<=r.to;){let o=t.doc.lineAt(n);o.number>i&&(r.empty||r.to>o.from)&&(e(o,s,r),i=o.number),n=o.to+1}let o=t.changes(s);return{changes:s,range:n.jT.range(o.mapPos(r.anchor,1),o.mapPos(r.head,1))}}))}const at=({state:t,dispatch:e})=>!t.readOnly&&(e(t.update(lt(t,((e,i)=>{i.push({from:e.from,insert:t.facet(o.c)})})),{userEvent:"input.indent"})),!0),ht=({state:t,dispatch:e})=>!t.readOnly&&(e(t.update(lt(t,((e,i)=>{let n=/^\s*/.exec(e.text)[0];if(!n)return;let s=(0,r.IS)(n,t.tabSize),l=0,a=(0,o.SS)(t,Math.max(0,s-(0,o.y1)(t)));for(;l<n.length&&l<a.length&&n.charCodeAt(l)==a.charCodeAt(l);)l++;i.push({from:e.from+l,to:e.from+n.length,insert:a.slice(l)})})),{userEvent:"delete.dedent"})),!0),ct=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:t=>p(t,(e=>x(t.state,e,t.textDirection!=s.Nm.LTR))),shift:t=>B(t,(e=>x(t.state,e,t.textDirection!=s.Nm.LTR)))},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:t=>p(t,(e=>x(t.state,e,t.textDirection==s.Nm.LTR))),shift:t=>B(t,(e=>x(t.state,e,t.textDirection==s.Nm.LTR)))},{key:"Alt-ArrowUp",run:({state:t,dispatch:e})=>nt(t,e,!1)},{key:"Shift-Alt-ArrowUp",run:({state:t,dispatch:e})=>rt(t,e,!1)},{key:"Alt-ArrowDown",run:({state:t,dispatch:e})=>nt(t,e,!0)},{key:"Shift-Alt-ArrowDown",run:({state:t,dispatch:e})=>rt(t,e,!0)},{key:"Escape",run:({state:t,dispatch:e})=>{let i=t.selection,r=null;return i.ranges.length>1?r=n.jT.create([i.main]):i.main.empty||(r=n.jT.create([n.jT.cursor(i.main.head)])),!!r&&(e(f(t,r)),!0)}},{key:"Mod-Enter",run:ot(!0)},{key:"Alt-l",mac:"Ctrl-l",run:({state:t,dispatch:e})=>{let i=it(t).map((({from:e,to:i})=>n.jT.range(e,Math.min(i+1,t.doc.length))));return e(t.update({selection:n.jT.create(i),userEvent:"select"})),!0}},{key:"Mod-i",run:({state:t,dispatch:e})=>{let i=u(t.selection,(e=>{var i;let r=(0,o.qz)(t).resolveInner(e.head,1);for(;!(r.from<e.from&&r.to>=e.to||r.to>e.to&&r.from<=e.from)&&(null===(i=r.parent)||void 0===i?void 0:i.parent);)r=r.parent;return n.jT.range(r.to,r.from)}));return e(f(t,i)),!0},preventDefault:!0},{key:"Mod-[",run:ht},{key:"Mod-]",run:at},{key:"Mod-Alt-\\",run:({state:t,dispatch:e})=>{if(t.readOnly)return!1;let i=Object.create(null),n=new o.Gn(t,{overrideIndentation:t=>{let e=i[t];return null==e?-1:e}}),r=lt(t,((e,r,s)=>{let l=(0,o.K0)(n,e.from);if(null==l)return;/\S/.test(e.text)||(l=0);let a=/^\s*/.exec(e.text)[0],h=(0,o.SS)(t,l);(a!=h||s.from<e.from+a.length)&&(i[e.from]=l,r.push({from:e.from,to:e.from+a.length,insert:h}))}));return r.changes.empty||e(t.update(r,{userEvent:"indent"})),!0}},{key:"Shift-Mod-k",run:t=>{if(t.state.readOnly)return!1;let{state:e}=t,i=e.changes(it(e).map((({from:t,to:i})=>(t>0?t--:i<e.doc.length&&i++,{from:t,to:i})))),n=u(e.selection,(e=>t.moveVertically(e,!0))).map(i);return t.dispatch({changes:i,selection:n,scrollIntoView:!0,userEvent:"delete.line"}),!0}},{key:"Shift-Mod-\\",run:({state:t,dispatch:e})=>O(t,e,!1)}].concat([{key:"ArrowLeft",run:g,shift:N,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:t=>v(t,t.textDirection!=s.Nm.LTR),shift:t=>R(t,t.textDirection!=s.Nm.LTR)},{mac:"Cmd-ArrowLeft",run:L,shift:F},{key:"ArrowRight",run:b,shift:E,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:t=>v(t,t.textDirection==s.Nm.LTR),shift:t=>R(t,t.textDirection==s.Nm.LTR)},{mac:"Cmd-ArrowRight",run:P,shift:$},{key:"ArrowUp",run:k,shift:q,preventDefault:!0},{mac:"Cmd-ArrowUp",run:W,shift:H},{mac:"Ctrl-ArrowUp",run:A,shift:_},{key:"ArrowDown",run:C,shift:j,preventDefault:!0},{mac:"Cmd-ArrowDown",run:U,shift:G},{mac:"Ctrl-ArrowDown",run:M,shift:V},{key:"PageUp",run:A,shift:_},{key:"PageDown",run:M,shift:V},{key:"Home",run:L,shift:F},{key:"Mod-Home",run:W,shift:H},{key:"End",run:P,shift:$},{key:"Mod-End",run:U,shift:G},{key:"Enter",run:st},{key:"Mod-a",run:({state:t,dispatch:e})=>(e(t.update({selection:{anchor:0,head:t.doc.length},userEvent:"select"})),!0)},{key:"Backspace",run:Z,shift:Z},{key:"Delete",run:X},{key:"Mod-Backspace",mac:"Alt-Backspace",run:tt},{key:"Mod-Delete",mac:"Alt-Delete",run:t=>Y(t,!0)},{mac:"Mod-Backspace",run:t=>Q(t,(e=>{let i=t.lineBlockAt(e).from;return K(t,e>i?i:Math.max(0,e-1),!1)}))},{mac:"Mod-Delete",run:et}].concat([{key:"Ctrl-b",run:g,shift:N,preventDefault:!0},{key:"Ctrl-f",run:b,shift:E},{key:"Ctrl-p",run:k,shift:q},{key:"Ctrl-n",run:C,shift:j},{key:"Ctrl-a",run:t=>p(t,(e=>n.jT.cursor(t.lineBlockAt(e.head).from,1))),shift:t=>B(t,(e=>n.jT.cursor(t.lineBlockAt(e.head).from)))},{key:"Ctrl-e",run:t=>p(t,(e=>n.jT.cursor(t.lineBlockAt(e.head).to,-1))),shift:t=>B(t,(e=>n.jT.cursor(t.lineBlockAt(e.head).to)))},{key:"Ctrl-d",run:X},{key:"Ctrl-h",run:Z},{key:"Ctrl-k",run:et},{key:"Ctrl-Alt-h",run:tt},{key:"Ctrl-o",run:({state:t,dispatch:e})=>{if(t.readOnly)return!1;let i=t.changeByRange((t=>({changes:{from:t.from,to:t.to,insert:r.xv.of(["",""])},range:n.jT.cursor(t.from)})));return e(t.update(i,{scrollIntoView:!0,userEvent:"input"})),!0}},{key:"Ctrl-t",run:({state:t,dispatch:e})=>{if(t.readOnly)return!1;let i=t.changeByRange((e=>{if(!e.empty||0==e.from||e.from==t.doc.length)return{range:e};let i=e.from,s=t.doc.lineAt(i),o=i==s.from?i-1:(0,r.cp)(s.text,i-s.from,!1)+s.from,l=i==s.to?i+1:(0,r.cp)(s.text,i-s.from,!0)+s.from;return{changes:{from:o,to:l,insert:t.doc.slice(i,l).append(t.doc.slice(o,i))},range:n.jT.cursor(l)}}));return!i.changes.empty&&(e(t.update(i,{scrollIntoView:!0,userEvent:"move.character"})),!0)}},{key:"Ctrl-v",run:M}].map((t=>({mac:t.key,run:t.run,shift:t.shift})))))},55987:(t,e,i)=>{i.d(e,{Eu:()=>C});var n=i(91643),r=i(67037),s=i(74075);class o extends r.uU{compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}eq(t){return!1}destroy(t){}}o.prototype.elementClass="",o.prototype.toDOM=void 0,o.prototype.mapMode=s.gc.TrackBefore,o.prototype.startSide=o.prototype.endSide=-1,o.prototype.point=!0;const l=s.r$.define(),a=s.r$.define();const h=n.tk.baseTheme({".cm-gutters":{display:"flex",height:"100%",boxSizing:"border-box",left:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#999",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"}}),c=s.r$.define({combine:t=>t.some((t=>t))});function u(t){let e=[f,h];return t&&!1===t.fixed&&e.push(c.of(!0)),e}const f=n.lg.fromClass(class{constructor(t){this.view=t,this.prevViewport=t.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight+"px",this.gutters=t.state.facet(a).map((e=>new g(t,e)));for(let t of this.gutters)this.dom.appendChild(t.dom);this.fixed=!t.state.facet(c),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),t.scrollDOM.insertBefore(this.dom,t.contentDOM)}update(t){if(this.updateGutters(t)){let e=this.prevViewport,i=t.view.viewport,n=Math.min(e.to,i.to)-Math.max(e.from,i.from);this.syncGutters(n<.8*(i.to-i.from))}t.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight+"px"),this.view.state.facet(c)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=t.view.viewport}syncGutters(t){let e=this.dom.nextSibling;t&&this.dom.remove();let i=r.Xs.iter(this.view.state.facet(l),this.view.viewport.from),s=[],o=this.gutters.map((t=>new m(t,this.view.viewport,-this.view.documentPadding.top)));for(let t of this.view.viewportLineBlocks){let e;if(Array.isArray(t.type)){for(let i of t.type)if(i.type==n.kH.Text){e=i;break}}else e=t.type==n.kH.Text?t:void 0;if(e){s.length&&(s=[]),d(i,s,t.from);for(let t of o)t.line(this.view,e,s)}}for(let t of o)t.finish();t&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(t){let e=t.startState.facet(a),i=t.state.facet(a),n=t.docChanged||t.heightChanged||t.viewportChanged||!r.Xs.eq(t.startState.facet(l),t.state.facet(l),t.view.viewport.from,t.view.viewport.to);if(e==i)for(let e of this.gutters)e.update(t)&&(n=!0);else{n=!0;let r=[];for(let n of i){let i=e.indexOf(n);i<0?r.push(new g(this.view,n)):(this.gutters[i].update(t),r.push(this.gutters[i]))}for(let t of this.gutters)t.dom.remove(),r.indexOf(t)<0&&t.destroy();for(let t of r)this.dom.appendChild(t.dom);this.gutters=r}return n}destroy(){for(let t of this.gutters)t.destroy();this.dom.remove()}},{provide:n.BF.scrollMargins.from((t=>0!=t.gutters.length&&t.fixed?t.view.textDirection==n.Nm.LTR?{left:t.dom.offsetWidth}:{right:t.dom.offsetWidth}:null))});function p(t){return Array.isArray(t)?t:[t]}function d(t,e,i){for(;t.value&&t.from<=i;)t.from==i&&e.push(t.value),t.next()}class m{constructor(t,e,i){this.gutter=t,this.height=i,this.localMarkers=[],this.i=0,this.cursor=r.Xs.iter(t.markers,e.from)}line(t,e,i){this.localMarkers.length&&(this.localMarkers=[]),d(this.cursor,this.localMarkers,e.from);let n=i.length?this.localMarkers.concat(i):this.localMarkers,r=this.gutter.config.lineMarker(t,e,n);r&&n.unshift(r);let s=this.gutter;if(0==n.length&&!s.config.renderEmptyElements)return;let o=e.top-this.height;if(this.i==s.elements.length){let i=new b(t,e.height,o,n);s.elements.push(i),s.dom.appendChild(i.dom)}else s.elements[this.i].update(t,e.height,o,n);this.height=e.bottom,this.i++}finish(){let t=this.gutter;for(;t.elements.length>this.i;){let e=t.elements.pop();t.dom.removeChild(e.dom),e.destroy()}}}class g{constructor(t,e){this.view=t,this.config=e,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let i in e.domEventHandlers)this.dom.addEventListener(i,(n=>{let r=t.lineBlockAtHeight(n.clientY-t.documentTop);e.domEventHandlers[i](t,r,n)&&n.preventDefault()}));this.markers=p(e.markers(t)),e.initialSpacer&&(this.spacer=new b(t,0,0,[e.initialSpacer(t)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(t){let e=this.markers;if(this.markers=p(this.config.markers(t.view)),this.spacer&&this.config.updateSpacer){let e=this.config.updateSpacer(this.spacer.markers[0],t);e!=this.spacer.markers[0]&&this.spacer.update(t.view,0,0,[e])}let i=t.view.viewport;return!r.Xs.eq(this.markers,e,i.from,i.to)||!!this.config.lineMarkerChange&&this.config.lineMarkerChange(t)}destroy(){for(let t of this.elements)t.destroy()}}class b{constructor(t,e,i,n){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.update(t,e,i,n)}update(t,e,i,n){this.height!=e&&(this.dom.style.height=(this.height=e)+"px"),this.above!=i&&(this.dom.style.marginTop=(this.above=i)?i+"px":""),function(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++)if(!t[i].compare(e[i]))return!1;return!0}(this.markers,n)||this.setMarkers(t,n)}setMarkers(t,e){let i="cm-gutterElement",n=this.dom.firstChild;for(let r=0,s=0;;){let o=s,l=r<e.length?e[r++]:null,a=!1;if(l){let t=l.elementClass;t&&(i+=" "+t);for(let t=s;t<this.markers.length;t++)if(this.markers[t].compare(l)){o=t,a=!0;break}}else o=this.markers.length;for(;s<o;){let t=this.markers[s++];if(t.toDOM){t.destroy(n);let e=n.nextSibling;n.remove(),n=e}}if(!l)break;l.toDOM&&(a?n=n.nextSibling:this.dom.insertBefore(l.toDOM(t),n)),a&&s++}this.dom.className=i,this.markers=e}destroy(){this.setMarkers(null,[])}}const v=s.r$.define(),y=s.r$.define({combine:t=>(0,s.BO)(t,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(t,e){let i=Object.assign({},t);for(let t in e){let n=i[t],r=e[t];i[t]=n?(t,e,i)=>n(t,e,i)||r(t,e,i):r}return i}})});class x extends o{constructor(t){super(),this.number=t}eq(t){return this.number==t.number}toDOM(){return document.createTextNode(this.number)}}function w(t,e){return t.state.facet(y).formatNumber(e,t.state)}const k=a.compute([y],(t=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers:t=>t.state.facet(v),lineMarker:(t,e,i)=>i.some((t=>t.toDOM))?null:new x(w(t,t.state.doc.lineAt(e.from).number)),lineMarkerChange:t=>t.startState.facet(y)!=t.state.facet(y),initialSpacer:t=>new x(w(t,S(t.state.doc.lines))),updateSpacer(t,e){let i=w(e.view,S(e.view.state.doc.lines));return i==t.number?t:new x(i)},domEventHandlers:t.facet(y).domEventHandlers})));function C(t={}){return[y.of(t),u(),k]}function S(t){let e=9;for(;e<t;)e=10*e+9;return e}},42484:(t,e,i)=>{i.d(e,{Qf:()=>x,Gv:()=>d,pJ:()=>$});var n=i(97248),r=i(28450),s=i(91643),o=i(74075),l=i(25070),a=i(67037);let h=0;class c{constructor(t,e,i){this.set=t,this.base=e,this.modified=i,this.id=h++}static define(t){if(null==t?void 0:t.base)throw new Error("Can not derive from a modified tag");let e=new c([],null,[]);if(e.set.push(e),t)for(let i of t.set)e.set.push(i);return e}static defineModifier(){let t=new f;return e=>e.modified.indexOf(t)>-1?e:f.get(e.base||e,e.modified.concat(t).sort(((t,e)=>t.id-e.id)))}}let u=0;class f{constructor(){this.instances=[],this.id=u++}static get(t,e){if(!e.length)return t;let i=e[0].instances.find((i=>{return i.base==t&&(n=e,r=i.modified,n.length==r.length&&n.every(((t,e)=>t==r[e])));var n,r}));if(i)return i;let n=[],r=new c(n,t,e);for(let t of e)t.instances.push(r);let s=p(e);for(let e of t.set)for(let t of s)n.push(f.get(e,t));return r}}function p(t){let e=[t];for(let i=0;i<t.length;i++)for(let n of p(t.slice(0,i).concat(t.slice(i+1))))e.push(n);return e}function d(t){let e=Object.create(null);for(let i in t){let n=t[i];Array.isArray(n)||(n=[n]);for(let t of i.split(" "))if(t){let i=[],r=2,s=t;for(let e=0;;){if("..."==s&&e>0&&e+3==t.length){r=1;break}let n=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(s);if(!n)throw new RangeError("Invalid path: "+t);if(i.push("*"==n[0]?null:'"'==n[0][0]?JSON.parse(n[0]):n[0]),e+=n[0].length,e==t.length)break;let o=t[e++];if(e==t.length&&"!"==o){r=0;break}if("/"!=o)throw new RangeError("Invalid path: "+t);s=t.slice(e)}let o=i.length-1,l=i[o];if(!l)throw new RangeError("Invalid path: "+t);let a=new y(n,r,o>0?i.slice(0,o):null);e[l]=a.sort(e[l])}}return m.add(e)}const m=new n.md,g=o.r$.define({combine:t=>t.length?x.combinedMatch(t):null}),b=o.r$.define({combine:t=>t.length?t[0].match:null});function v(t){return t.facet(g)||t.facet(b)}class y{constructor(t,e,i,n){this.tags=t,this.mode=e,this.context=i,this.next=n}sort(t){return!t||t.depth<this.depth?(this.next=t,this):(t.next=this.sort(t.next),t)}get depth(){return this.context?this.context.length:0}}class x{constructor(t,e){let i;function n(t){let e=r.V.newName();return(i||(i=Object.create(null)))["."+e]=t,e}this.map=Object.create(null),this.all="string"==typeof e.all?e.all:e.all?n(e.all):null;for(let e of t){let t=(e.class||n(Object.assign({},e,{tag:null})))+(this.all?" "+this.all:""),i=e.tag;if(Array.isArray(i))for(let e of i)this.map[e.id]=t;else this.map[i.id]=t}this.module=i?new r.V(i):null,this.scope=e.scope||null,this.match=this.match.bind(this);let o=[k];this.module&&o.push(s.tk.styleModule.of(this.module)),this.extension=o.concat(g.of(this)),this.fallback=o.concat(b.of(this))}match(t,e){if(this.scope&&e!=this.scope)return null;for(let e of t.set){let i=this.map[e.id];if(void 0!==i)return e!=t&&(this.map[t.id]=i),i}return this.map[t.id]=this.all}static combinedMatch(t){if(1==t.length)return t[0].match;let e=t.some((t=>t.scope))?void 0:Object.create(null);return(i,n)=>{let r=e&&e[i.id];if(void 0!==r)return r;let s=null;for(let e of t){let t=e.match(i,n);t&&(s=s?s+" "+t:t)}return e&&(e[i.id]=s),s}}static define(t,e){return new x(t,e||{})}static get(t,e,i){let r=v(t);return r&&r(e,i||n.Jq.none)}}class w{constructor(t){this.markCache=Object.create(null),this.tree=(0,l.qz)(t.state),this.decorations=this.buildDeco(t,v(t.state))}update(t){let e=(0,l.qz)(t.state),i=v(t.state),n=i!=t.startState.facet(g);e.length<t.view.viewport.to&&!n&&e.type==this.tree.type?this.decorations=this.decorations.map(t.changes):(e!=this.tree||t.viewportChanged||n)&&(this.tree=e,this.decorations=this.buildDeco(t.view,i))}buildDeco(t,e){if(!e||!this.tree.length)return s.p.none;let i=new a.f_;for(let{from:n,to:r}of t.visibleRanges)A(this.tree,n,r,e,((t,e,n)=>{i.add(t,e,this.markCache[n]||(this.markCache[n]=s.p.mark({class:n})))}));return i.finish()}}const k=o.Wl.high(s.lg.fromClass(w,{decorations:t=>t.decorations})),C=[""];class S{constructor(t,e,i){this.at=t,this.style=e,this.span=i,this.class=""}startSpan(t,e){e!=this.class&&(this.flush(t),t>this.at&&(this.at=t),this.class=e)}flush(t){t>this.at&&this.class&&this.span(this.at,t,this.class)}highlightRange(t,e,i,r,s,o){let{type:l,from:a,to:h}=t;if(a>=i||h<=e)return;C[s]=l.name,l.isTop&&(o=l);let c=r,u=l.prop(m),f=!1;for(;u;){if(!u.context||M(u.context,C,s)){for(let t of u.tags){let e=this.style(t,o);e&&(c&&(c+=" "),c+=e,1==u.mode?r+=(r?" ":"")+e:0==u.mode&&(f=!0))}break}u=u.next}if(this.startSpan(t.from,c),f)return;let p=t.tree&&t.tree.prop(n.md.mounted);if(p&&p.overlay){let n=t.node.enter(p.overlay[0].from+a,1),l=t.firstChild();for(let u=0,f=a;;u++){let d=u<p.overlay.length?p.overlay[u]:null,m=d?d.from+a:h,g=Math.max(e,f),b=Math.min(i,m);if(g<b&&l)for(;t.from<b&&(this.highlightRange(t,g,b,r,s+1,o),this.startSpan(Math.min(i,t.to),c),!(t.to>=m)&&t.nextSibling()););if(!d||m>i)break;f=d.to+a,f>e&&(this.highlightRange(n.cursor,Math.max(e,d.from+a),Math.min(i,f),r,s,p.tree.type),this.startSpan(f,c))}l&&t.parent()}else if(t.firstChild()){do{if(!(t.to<=e)){if(t.from>=i)break;this.highlightRange(t,e,i,r,s+1,o),this.startSpan(Math.min(i,t.to),c)}}while(t.nextSibling());t.parent()}}}function A(t,e,i,n,r){let s=new S(e,n,r);s.highlightRange(t.cursor(),e,i,"",0,t.type),s.flush(i)}function M(t,e,i){if(t.length>i-1)return!1;for(let n=i-1,r=t.length-1;r>=0;r--,n--){let i=t[r];if(i&&i!=e[n])return!1}return!0}const T=c.define,P=T(),L=T(),O=T(L),B=T(L),D=T(),N=T(D),E=T(D),R=T(),I=T(R),q=T(),j=T(),z=T(),_=T(z),V=T(),$={comment:P,lineComment:T(P),blockComment:T(P),docComment:T(P),name:L,variableName:T(L),typeName:O,tagName:T(O),propertyName:B,attributeName:T(B),className:T(L),labelName:T(L),namespace:T(L),macroName:T(L),literal:D,string:N,docString:T(N),character:T(N),attributeValue:T(N),number:E,integer:T(E),float:T(E),bool:T(D),regexp:T(D),escape:T(D),color:T(D),url:T(D),keyword:q,self:T(q),null:T(q),atom:T(q),unit:T(q),modifier:T(q),operatorKeyword:T(q),controlKeyword:T(q),definitionKeyword:T(q),moduleKeyword:T(q),operator:j,derefOperator:T(j),arithmeticOperator:T(j),logicOperator:T(j),bitwiseOperator:T(j),compareOperator:T(j),updateOperator:T(j),definitionOperator:T(j),typeOperator:T(j),controlOperator:T(j),punctuation:z,separator:T(z),bracket:_,angleBracket:T(_),squareBracket:T(_),paren:T(_),brace:T(_),content:R,heading:I,heading1:T(I),heading2:T(I),heading3:T(I),heading4:T(I),heading5:T(I),heading6:T(I),contentSeparator:T(R),list:T(R),quote:T(R),emphasis:T(R),strong:T(R),link:T(R),monospace:T(R),strikethrough:T(R),inserted:T(),deleted:T(),changed:T(),invalid:T(),meta:V,documentMeta:T(V),annotation:T(V),processingInstruction:T(V),definition:c.defineModifier(),constant:c.defineModifier(),function:c.defineModifier(),standard:c.defineModifier(),local:c.defineModifier(),special:c.defineModifier()};$.link,$.heading,$.emphasis,$.strong,$.strikethrough,$.keyword,$.atom,$.bool,$.url,$.contentSeparator,$.labelName,$.literal,$.inserted,$.string,$.deleted,$.regexp,$.escape,$.string,$.variableName,$.variableName,$.typeName,$.namespace,$.className,$.variableName,$.macroName,$.propertyName,$.comment,$.meta,$.invalid,$.link,$.heading,$.emphasis,$.strong,$.keyword,$.atom,$.bool,$.url,$.labelName,$.inserted,$.deleted,$.literal,$.string,$.number,$.regexp,$.escape,$.string,$.variableName,$.variableName,$.variableName,$.variableName,$.propertyName,$.typeName,$.namespace,$.className,$.macroName,$.propertyName,$.operator,$.comment,$.meta,$.invalid,$.punctuation},25070:(t,e,i)=>{i.d(e,{Gn:()=>M,SQ:()=>h,Be:()=>d,kU:()=>a,y1:()=>C,K0:()=>A,tK:()=>w,SS:()=>S,c:()=>k,mi:()=>l,qz:()=>u});var n=i(97248),r=i(74075),s=i(91643),o=i(51686);const l=new n.md;function a(t){return r.r$.define({combine:t?e=>e.concat(t):void 0})}class h{constructor(t,e,i,n=[]){this.data=t,this.topNode=i,r.yy.prototype.hasOwnProperty("tree")||Object.defineProperty(r.yy.prototype,"tree",{get(){return u(this)}}),this.parser=e,this.extension=[x.of(this),r.yy.languageData.of(((t,e,i)=>t.facet(c(t,e,i))))].concat(n)}isActiveAt(t,e,i=-1){return c(t,e,i)==this.data}findRegions(t){let e=t.facet(x);if((null==e?void 0:e.data)==this.data)return[{from:0,to:t.doc.length}];if(!e||!e.allowsNesting)return[];let i=[],r=(t,e)=>{if(t.prop(l)==this.data)return void i.push({from:e,to:e+t.length});let s=t.prop(n.md.mounted);if(s){if(s.tree.prop(l)==this.data){if(s.overlay)for(let t of s.overlay)i.push({from:t.from+e,to:t.to+e});else i.push({from:e,to:e+t.length});return}if(s.overlay){let t=i.length;if(r(s.tree,s.overlay[0].from+e),i.length>t)return}}for(let i=0;i<t.children.length;i++){let s=t.children[i];s instanceof n.mp&&r(s,t.positions[i]+e)}};return r(u(t),0),i}get allowsNesting(){return!0}}function c(t,e,i){let n=t.facet(x);if(!n)return null;let r=n.data;if(n.allowsNesting)for(let n=u(t).topNode;n;n=n.enter(e,i,!0,!1))r=n.type.prop(l)||r;return r}h.setState=r.Py.define();function u(t){let e=t.field(h.state,!1);return e?e.tree:n.mp.empty}class f{constructor(t,e=t.length){this.doc=t,this.length=e,this.cursorPos=0,this.string="",this.cursor=t.iter()}syncTo(t){return this.string=this.cursor.next(t-this.cursorPos).value,this.cursorPos=t+this.string.length,this.cursorPos-this.string.length}chunk(t){return this.syncTo(t),this.string}get lineChunks(){return!0}read(t,e){let i=this.cursorPos-this.string.length;return t<i||e>=this.cursorPos?this.doc.sliceString(t,e):this.string.slice(t-i,e-i)}}let p=null;class d{constructor(t,e,i=[],n,r,s,o,l){this.parser=t,this.state=e,this.fragments=i,this.tree=n,this.treeLen=r,this.viewport=s,this.skipped=o,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}startParse(){return this.parser.startParse(new f(this.state.doc),this.fragments)}work(t,e){return null!=e&&e>=this.state.doc.length&&(e=void 0),this.tree!=n.mp.empty&&(null==e?this.treeLen==this.state.doc.length:this.treeLen>=e)?(this.takeTree(),!0):this.withContext((()=>{var i;this.parse||(this.parse=this.startParse()),null!=e&&(null==this.parse.stoppedAt||this.parse.stoppedAt>e)&&e<this.state.doc.length&&this.parse.stopAt(e);let r=Date.now()+t;for(;;){let t=this.parse.advance();if(t){if(this.fragments=this.withoutTempSkipped(n.i9.addTree(t,this.fragments,null!=this.parse.stoppedAt)),this.treeLen=null!==(i=this.parse.stoppedAt)&&void 0!==i?i:this.state.doc.length,this.tree=t,this.parse=null,!(this.treeLen<(null!=e?e:this.state.doc.length)))return!0;this.parse=this.startParse()}if(Date.now()>r)return!1}}))}takeTree(){let t,e;this.parse&&(t=this.parse.parsedPos)>this.treeLen&&((null==this.parse.stoppedAt||this.parse.stoppedAt>t)&&this.parse.stopAt(t),this.withContext((()=>{for(;!(e=this.parse.advance()););})),this.tree=e,this.fragments=this.withoutTempSkipped(n.i9.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(t){let e=p;p=this;try{return t()}finally{p=e}}withoutTempSkipped(t){for(let e;e=this.tempSkipped.pop();)t=m(t,e.from,e.to);return t}changes(t,e){let{fragments:i,tree:r,treeLen:s,viewport:o,skipped:l}=this;if(this.takeTree(),!t.empty){let e=[];if(t.iterChangedRanges(((t,i,n,r)=>e.push({fromA:t,toA:i,fromB:n,toB:r}))),i=n.i9.applyChanges(i,e),r=n.mp.empty,s=0,o={from:t.mapPos(o.from,-1),to:t.mapPos(o.to,1)},this.skipped.length){l=[];for(let e of this.skipped){let i=t.mapPos(e.from,1),n=t.mapPos(e.to,-1);i<n&&l.push({from:i,to:n})}}}return new d(this.parser,e,i,r,s,o,l,this.scheduleOn)}updateViewport(t){this.viewport=t;let e=this.skipped.length;for(let e=0;e<this.skipped.length;e++){let{from:i,to:n}=this.skipped[e];i<t.to&&n>t.from&&(this.fragments=m(this.fragments,i,n),this.skipped.splice(e--,1))}return this.skipped.length<e}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(t,e){this.skipped.push({from:t,to:e})}static getSkippingParser(t){return new class extends n._b{createParse(e,i,r){let s=r[0].from,o=r[r.length-1].to;return{parsedPos:s,advance(){let e=p;if(e){for(let t of r)e.tempSkipped.push(t);t&&(e.scheduleOn=e.scheduleOn?Promise.all([e.scheduleOn,t]):t)}return this.parsedPos=o,new n.mp(n.Jq.none,[],[],o-s)},stoppedAt:null,stopAt(){}}}}}movedPast(t){return this.treeLen<t&&this.parse&&this.parse.parsedPos>=t}static get(){return p}}function m(t,e,i){return n.i9.applyChanges(t,[{fromA:e,toA:i,fromB:e,toB:i}])}class g{constructor(t){this.context=t,this.tree=t.tree}apply(t){if(!t.docChanged)return this;let e=this.context.changes(t.changes,t.state),i=this.context.treeLen==t.startState.doc.length?void 0:Math.max(t.changes.mapPos(this.context.treeLen),e.viewport.to);return e.work(25,i)||e.takeTree(),new g(e)}static init(t){let e=new d(t.facet(x).parser,t,[],n.mp.empty,0,{from:0,to:t.doc.length},[],null);return e.work(25)||e.takeTree(),new g(e)}}h.state=r.QQ.define({create:g.init,update(t,e){for(let t of e.effects)if(t.is(h.setState))return t.value;return e.startState.facet(x)!=e.state.facet(x)?g.init(e.state):t.apply(e)}});let b="undefined"!=typeof window&&window.requestIdleCallback||((t,{timeout:e})=>setTimeout(t,e)),v="undefined"!=typeof window&&window.cancelIdleCallback||clearTimeout;const y=s.lg.fromClass(class{constructor(t){this.view=t,this.working=-1,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(t){let e=this.view.state.field(h.state).context;t.viewportChanged&&(e.updateViewport(t.view.viewport)&&e.reset(),this.view.viewport.to>e.treeLen&&this.scheduleWork()),t.docChanged&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(e)}scheduleWork(){if(this.working>-1)return;let{state:t}=this.view,e=t.field(h.state),i=e.context.fragments;e.tree==e.context.tree&&e.context.treeLen>=t.doc.length&&i.length&&0==i[0].from&&i[0].to>=t.doc.length||(this.working=b(this.work,{timeout:500}))}work(t){this.working=-1;let e=Date.now();if(this.chunkEnd<e&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=e+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:i,viewport:{to:n}}=this.view,r=i.field(h.state);if(r.tree==r.context.tree&&r.context.treeLen>=n+1e6)return;let s=Math.min(this.chunkBudget,t?Math.max(25,t.timeRemaining()):100),o=r.context.work(s,n+1e6);this.chunkBudget-=Date.now()-e,(o||this.chunkBudget<=0||r.context.movedPast(n))&&(r.context.takeTree(),this.view.dispatch({effects:h.setState.of(new g(r.context))})),!o&&this.chunkBudget>0&&this.scheduleWork(),this.checkAsyncSchedule(r.context)}checkAsyncSchedule(t){t.scheduleOn&&(t.scheduleOn.then((()=>this.scheduleWork())),t.scheduleOn=null)}destroy(){this.working>=0&&v(this.working)}},{eventHandlers:{focus(){this.scheduleWork()}}}),x=r.r$.define({combine:t=>t.length?t[0]:null,enables:[h.state,y]});const w=r.r$.define(),k=r.r$.define({combine:t=>{if(!t.length)return"  ";if(!/^(?: +|\t+)$/.test(t[0]))throw new Error("Invalid indent unit: "+JSON.stringify(t[0]));return t[0]}});function C(t){let e=t.facet(k);return 9==e.charCodeAt(0)?t.tabSize*e.length:e.length}function S(t,e){let i="",n=t.tabSize;if(9==t.facet(k).charCodeAt(0))for(;e>=n;)i+="\t",e-=n;for(let t=0;t<e;t++)i+=" ";return i}function A(t,e){t instanceof r.yy&&(t=new M(t));for(let i of t.state.facet(w)){let n=i(t,e);if(null!=n)return n}let i=u(t.state);return i?function(t,e,i){let n=e.resolveInner(i);for(let t=n,e=i;;){let i=t.childBefore(e);if(!i)break;i.type.isError&&i.from==i.to?(n=t,e=i.from):(t=i,e=t.to+1)}return L(n,i,t)}(t,i,e):null}class M{constructor(t,e={}){this.state=t,this.options=e,this.unit=C(t)}lineAt(t,e=1){let i=this.state.doc.lineAt(t),{simulateBreak:n}=this.options;return null!=n&&n>=i.from&&n<=i.to?(e<0?n<t:n<=t)?{text:i.text.slice(n-i.from),from:n}:{text:i.text.slice(0,n-i.from),from:i.from}:i}textAfterPos(t,e=1){if(this.options.simulateDoubleBreak&&t==this.options.simulateBreak)return"";let{text:i,from:n}=this.lineAt(t,e);return i.slice(t-n,Math.min(i.length,t+100-n))}column(t,e=1){let{text:i,from:n}=this.lineAt(t,e),r=this.countColumn(i,t-n),s=this.options.overrideIndentation?this.options.overrideIndentation(n):-1;return s>-1&&(r+=s-this.countColumn(i,i.search(/\S|$/))),r}countColumn(t,e=t.length){return(0,o.IS)(t,this.state.tabSize,e)}lineIndent(t,e=1){let{text:i,from:n}=this.lineAt(t,e),r=this.options.overrideIndentation;if(r){let t=r(n);if(t>-1)return t}return this.countColumn(i,i.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const T=new n.md;function P(t){let e=t.type.prop(T);if(e)return e;let i,r=t.firstChild;if(r&&(i=r.type.prop(n.md.closedBy))){let e=t.lastChild,n=e&&i.indexOf(e.name)>-1;return t=>N(t,!0,1,void 0,n&&!function(t){return t.pos==t.options.simulateBreak&&t.options.simulateDoubleBreak}(t)?e.from:void 0)}return null==t.parent?O:null}function L(t,e,i){for(;t;t=t.parent){let n=P(t);if(n)return n(new B(i,e,t))}return null}function O(){return 0}class B extends M{constructor(t,e,i){super(t.state,t.options),this.base=t,this.pos=e,this.node=i}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){let t=this.state.doc.lineAt(this.node.from);for(;;){let e=this.node.resolve(t.from);for(;e.parent&&e.parent.from==e.from;)e=e.parent;if(D(e,this.node))break;t=this.state.doc.lineAt(e.from)}return this.lineIndent(t.from)}continue(){let t=this.node.parent;return t?L(t,this.pos,this.base):0}}function D(t,e){for(let i=e;i;i=i.parent)if(t==i)return!0;return!1}function N(t,e,i,n,r){let s=t.textAfter,o=s.match(/^\s*/)[0].length,l=n&&s.slice(o,o+n.length)==n||r==t.pos+o,a=e?function(t){let e=t.node,i=e.childAfter(e.from),n=e.lastChild;if(!i)return null;let r=t.options.simulateBreak,s=t.state.doc.lineAt(i.from),o=null==r||r<=s.from?s.to:Math.min(s.to,r);for(let t=i.to;;){let r=e.childAfter(t);if(!r||r==n)return null;if(!r.type.isSkipped)return r.from<o?i:null;t=r.to}}(t):null;return a?l?t.column(a.from):t.column(a.to):t.baseIndent+(l?0:t.unit*i)}},17429:(t,e,i)=>{i.d(e,{b:()=>h});var n=["and","as","block","endblock","by","cycle","debug","else","elif","extends","filter","endfilter","firstof","for","endfor","if","endif","ifchanged","endifchanged","ifequal","endifequal","ifnotequal","endifnotequal","in","include","load","not","now","or","parsed","regroup","reversed","spaceless","endspaceless","ssi","templatetag","openblock","closeblock","openvariable","closevariable","openbrace","closebrace","opencomment","closecomment","widthratio","url","with","endwith","get_current_language","trans","endtrans","noop","blocktrans","endblocktrans","get_available_languages","get_current_language_bidi","plural"],r=/^[+\-*&%=<>!?|~^]/,s=/^[:\[\(\{]/,o=["true","false"],l=/^(\d[+\-\*\/])?\d+(\.\d+)?/;function a(t,e){var i=t.peek();if(e.incomment)return t.skipTo("#}")?(t.eatWhile(/\#|}/),e.incomment=!1):t.skipToEnd(),"comment";if(e.intag){if(e.operator){if(e.operator=!1,t.match(o))return"atom";if(t.match(l))return"number"}if(e.sign){if(e.sign=!1,t.match(o))return"atom";if(t.match(l))return"number"}if(e.instring)return i==e.instring&&(e.instring=!1),t.next(),"string";if("'"==i||'"'==i)return e.instring=i,t.next(),"string";if(t.match(e.intag+"}")||t.eat("-")&&t.match(e.intag+"}"))return e.intag=!1,"tag";if(t.match(r))return e.operator=!0,"operator";if(t.match(s))e.sign=!0;else if(t.eat(" ")||t.sol()){if(t.match(n))return"keyword";if(t.match(o))return"atom";if(t.match(l))return"number";t.sol()&&t.next()}else t.next();return"variable"}if(t.eat("{")){if(t.eat("#"))return e.incomment=!0,t.skipTo("#}")?(t.eatWhile(/\#|}/),e.incomment=!1):t.skipToEnd(),"comment";if(i=t.eat(/\{|%/))return e.intag=i,"{"==i&&(e.intag="}"),t.eat("-"),"tag"}t.next()}n=new RegExp("(("+n.join(")|(")+"))\\b"),o=new RegExp("(("+o.join(")|(")+"))\\b");const h={startState:function(){return{tokenize:a}},token:function(t,e){return e.tokenize(t,e)},languageData:{commentTokens:{block:{open:"{#",close:"#}"}}}}},76697:(t,e,i)=>{i.d(e,{r:()=>r});var n=new RegExp("\\b(("+["true","false","on","off","yes","no"].join(")|(")+"))$","i");const r={token:function(t,e){var i=t.peek(),r=e.escaped;if(e.escaped=!1,"#"==i&&(0==t.pos||/\s/.test(t.string.charAt(t.pos-1))))return t.skipToEnd(),"comment";if(t.match(/^('([^']|\\.)*'?|"([^"]|\\.)*"?)/))return"string";if(e.literal&&t.indentation()>e.keyCol)return t.skipToEnd(),"string";if(e.literal&&(e.literal=!1),t.sol()){if(e.keyCol=0,e.pair=!1,e.pairStart=!1,t.match("---"))return"def";if(t.match("..."))return"def";if(t.match(/^\s*-\s+/))return"meta"}if(t.match(/^(\{|\}|\[|\])/))return"{"==i?e.inlinePairs++:"}"==i?e.inlinePairs--:"["==i?e.inlineList++:e.inlineList--,"meta";if(e.inlineList>0&&!r&&","==i)return t.next(),"meta";if(e.inlinePairs>0&&!r&&","==i)return e.keyCol=0,e.pair=!1,e.pairStart=!1,t.next(),"meta";if(e.pairStart){if(t.match(/^\s*(\||\>)\s*/))return e.literal=!0,"meta";if(t.match(/^\s*(\&|\*)[a-z0-9\._-]+\b/i))return"variable";if(0==e.inlinePairs&&t.match(/^\s*-?[0-9\.\,]+\s?$/))return"number";if(e.inlinePairs>0&&t.match(/^\s*-?[0-9\.\,]+\s?(?=(,|}))/))return"number";if(t.match(n))return"keyword"}return!e.pair&&t.match(/^\s*(?:[,\[\]{}&*!|>'"%@`][^\s'":]|[^,\[\]{}#&*!|>'"%@`])[^#]*?(?=\s*:($|\s))/)?(e.pair=!0,e.keyCol=t.indentation(),"atom"):e.pair&&t.match(/^:\s*/)?(e.pairStart=!0,"meta"):(e.pairStart=!1,e.escaped="\\"==i,t.next(),null)},startState:function(){return{pair:!1,pairStart:!1,keyCol:0,inlinePairs:0,inlineList:0,literal:!1,escaped:!1}},languageData:{commentTokens:{line:"#"}}}},42454:(t,e,i)=>{i.d(e,{Z:()=>h});var n=i(74075),r=i(91643),s=i(51686);const o=2e3;function l(t,e){let i=t.posAtCoords({x:e.clientX,y:e.clientY},!1),n=t.state.doc.lineAt(i),r=i-n.from,l=r>o?-1:r==n.length?function(t,e){let i=t.coordsAtPos(t.viewport.from);return i?Math.round(Math.abs((i.left-e)/t.defaultCharacterWidth)):-1}(t,e.clientX):(0,s.IS)(n.text,t.state.tabSize,i-n.from);return{line:n.number,col:l,off:r}}function a(t,e){let i=l(t,e),r=t.state.selection;return i?{update(t){if(t.docChanged){let e=t.changes.mapPos(t.startState.doc.line(i.line).from),n=t.state.doc.lineAt(e);i={line:n.number,col:i.col,off:Math.min(i.off,n.length)},r=r.map(t.changes)}},get(e,a,h){let c=l(t,e);if(!c)return r;let u=function(t,e,i){let r=Math.min(e.line,i.line),l=Math.max(e.line,i.line),a=[];if(e.off>o||i.off>o||e.col<0||i.col<0){let s=Math.min(e.off,i.off),o=Math.max(e.off,i.off);for(let e=r;e<=l;e++){let i=t.doc.line(e);i.length<=o&&a.push(n.jT.range(i.from+s,i.to+o))}}else{let o=Math.min(e.col,i.col),h=Math.max(e.col,i.col);for(let e=r;e<=l;e++){let i=t.doc.line(e),r=(0,s.Gz)(i.text,o,t.tabSize,!0);if(r>-1){let e=(0,s.Gz)(i.text,h,t.tabSize);a.push(n.jT.range(i.from+r,i.from+e))}}}return a}(t.state,i,c);return u.length?h?n.jT.create(u.concat(r.ranges)):n.jT.create(u):r}}:null}function h(t){let e=(null==t?void 0:t.eventFilter)||(t=>t.altKey&&0==t.button);return r.tk.mouseSelectionStyle.of(((t,i)=>e(i)?a(t,i):null))}},86315:(t,e,i)=>{i.d(e,{sW:()=>O,Lp:()=>nt});var n=i(91643),r=i(74075);const s=r.r$.define({combine(t){let e,i;for(let n of t)e=e||n.topContainer,i=i||n.bottomContainer;return{topContainer:e,bottomContainer:i}}});function o(t,e){let i=t.plugin(l),n=i?i.specs.indexOf(e):-1;return n>-1?i.panels[n]:null}const l=n.lg.fromClass(class{constructor(t){this.input=t.state.facet(u),this.specs=this.input.filter((t=>t)),this.panels=this.specs.map((e=>e(t)));let e=t.state.facet(s);this.top=new a(t,!0,e.topContainer),this.bottom=new a(t,!1,e.bottomContainer),this.top.sync(this.panels.filter((t=>t.top))),this.bottom.sync(this.panels.filter((t=>!t.top)));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(t){let e=t.state.facet(s);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new a(t.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new a(t.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let i=t.state.facet(u);if(i!=this.input){let e=i.filter((t=>t)),n=[],r=[],s=[],o=[];for(let i of e){let e,l=this.specs.indexOf(i);l<0?(e=i(t.view),o.push(e)):(e=this.panels[l],e.update&&e.update(t)),n.push(e),(e.top?r:s).push(e)}this.specs=e,this.panels=n,this.top.sync(r),this.bottom.sync(s);for(let t of o)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}else for(let e of this.panels)e.update&&e.update(t)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:n.BF.scrollMargins.from((t=>({top:t.top.scrollMargin(),bottom:t.bottom.scrollMargin()})))});class a{constructor(t,e,i){this.view=t,this.top=e,this.container=i,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(t){this.panels=t,this.syncDOM()}syncDOM(){if(0==this.panels.length)return void(this.dom&&(this.dom.remove(),this.dom=void 0));if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let t=this.dom.firstChild;for(let e of this.panels)if(e.dom.parentNode==this.dom){for(;t!=e.dom;)t=h(t);t=t.nextSibling}else this.dom.insertBefore(e.dom,t);for(;t;)t=h(t)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(this.container&&this.classes!=this.view.themeClasses){for(let t of this.classes.split(" "))t&&this.container.classList.remove(t);for(let t of(this.classes=this.view.themeClasses).split(" "))t&&this.container.classList.add(t)}}}function h(t){let e=t.nextSibling;return t.remove(),e}const c=n.tk.baseTheme({".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"}}),u=r.r$.define({enables:[l,c]});var f=i(67037);function p(){var t=arguments[0];"string"==typeof t&&(t=document.createElement(t));var e=1,i=arguments[1];if(i&&"object"==typeof i&&null==i.nodeType&&!Array.isArray(i)){for(var n in i)if(Object.prototype.hasOwnProperty.call(i,n)){var r=i[n];"string"==typeof r?t.setAttribute(n,r):null!=r&&(t[n]=r)}e++}for(;e<arguments.length;e++)d(t,arguments[e]);return t}function d(t,e){if("string"==typeof e)t.appendChild(document.createTextNode(e));else if(null==e);else if(null!=e.nodeType)t.appendChild(e);else{if(!Array.isArray(e))throw new RangeError("Unsupported child node: "+e);for(var i=0;i<e.length;i++)d(t,e[i])}}var m=i(51686);const g="function"==typeof String.prototype.normalize?t=>t.normalize("NFKD"):t=>t;class b{constructor(t,e,i=0,n=t.length,r){this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=t.iterRange(i,n),this.bufferStart=i,this.normalize=r?t=>r(g(t)):g,this.query=this.normalize(e)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return(0,m.gm)(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let t=this.peek();if(t<0)return this.done=!0,this;let e=(0,m.bg)(t),i=this.bufferStart+this.bufferPos;this.bufferPos+=(0,m.nZ)(t);let n=this.normalize(e);for(let t=0,r=i;;t++){let s=n.charCodeAt(t),o=this.match(s,r);if(o)return this.value=o,this;if(t==n.length-1)break;r==i&&t<e.length&&e.charCodeAt(t)==s&&r++}}}match(t,e){let i=null;for(let n=0;n<this.matches.length;n+=2){let r=this.matches[n],s=!1;this.query.charCodeAt(r)==t&&(r==this.query.length-1?i={from:this.matches[n+1],to:e+1}:(this.matches[n]++,s=!0)),s||(this.matches.splice(n,2),n-=2)}return this.query.charCodeAt(0)==t&&(1==this.query.length?i={from:e,to:e+1}:this.matches.push(1,e)),i}}"undefined"!=typeof Symbol&&(b.prototype[Symbol.iterator]=function(){return this});const v={from:-1,to:-1,match:/.*/.exec("")},y="gm"+(null==/x/.unicode?"":"u");class x{constructor(t,e,i,n=0,r=t.length){if(this.to=r,this.curLine="",this.done=!1,this.value=v,/\\[sWDnr]|\n|\r|\[\^/.test(e))return new C(t,e,i,n,r);this.re=new RegExp(e,y+((null==i?void 0:i.ignoreCase)?"i":"")),this.iter=t.iter();let s=t.lineAt(n);this.curLineStart=s.from,this.matchPos=n,this.getLine(this.curLineStart)}getLine(t){this.iter.next(t),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let t=this.matchPos-this.curLineStart;;){this.re.lastIndex=t;let e=this.matchPos<=this.to&&this.re.exec(this.curLine);if(e){let i=this.curLineStart+e.index,n=i+e[0].length;if(this.matchPos=n+(i==n?1:0),i==this.curLine.length&&this.nextLine(),i<n||i>this.value.to)return this.value={from:i,to:n,match:e},this;t=this.matchPos-this.curLineStart}else{if(!(this.curLineStart+this.curLine.length<this.to))return this.done=!0,this;this.nextLine(),t=0}}}}const w=new WeakMap;class k{constructor(t,e){this.from=t,this.text=e}get to(){return this.from+this.text.length}static get(t,e,i){let n=w.get(t);if(!n||n.from>=i||n.to<=e){let n=new k(e,t.sliceString(e,i));return w.set(t,n),n}if(n.from==e&&n.to==i)return n;let{text:r,from:s}=n;return s>e&&(r=t.sliceString(e,s)+r,s=e),n.to<i&&(r+=t.sliceString(n.to,i)),w.set(t,new k(s,r)),new k(e,r.slice(e-s,i-s))}}class C{constructor(t,e,i,n,r){this.text=t,this.to=r,this.done=!1,this.value=v,this.matchPos=n,this.re=new RegExp(e,y+((null==i?void 0:i.ignoreCase)?"i":"")),this.flat=k.get(t,n,this.chunkEnd(n+5e3))}chunkEnd(t){return t>=this.to?this.to:this.text.lineAt(t).to}next(){for(;;){let t=this.re.lastIndex=this.matchPos-this.flat.from,e=this.re.exec(this.flat.text);if(e&&!e[0]&&e.index==t&&(this.re.lastIndex=t+1,e=this.re.exec(this.flat.text)),e&&this.flat.to<this.to&&e.index+e[0].length>this.flat.text.length-10&&(e=null),e){let t=this.flat.from+e.index,i=t+e[0].length;return this.value={from:t,to:i,match:e},this.matchPos=i+(t==i?1:0),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=k.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+2*this.flat.text.length))}}}function S(t){let e=p("input",{class:"cm-textfield",name:"line"});function i(){let i=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(e.value);if(!i)return;let{state:n}=t,s=n.doc.lineAt(n.selection.main.head),[,o,l,a,h]=i,c=a?+a.slice(1):0,u=l?+l:s.number;if(l&&h){let t=u/100;o&&(t=t*("-"==o?-1:1)+s.number/n.doc.lines),u=Math.round(n.doc.lines*t)}else l&&o&&(u=u*("-"==o?-1:1)+s.number);let f=n.doc.line(Math.max(1,Math.min(n.doc.lines,u)));t.dispatch({effects:A.of(!1),selection:r.jT.cursor(f.from+Math.max(0,Math.min(c,f.length))),scrollIntoView:!0}),t.focus()}return{dom:p("form",{class:"cm-gotoLine",onkeydown:e=>{27==e.keyCode?(e.preventDefault(),t.dispatch({effects:A.of(!1)}),t.focus()):13==e.keyCode&&(e.preventDefault(),i())},onsubmit:t=>{t.preventDefault(),i()}},p("label",t.state.phrase("Go to line"),": ",e)," ",p("button",{class:"cm-button",type:"submit"},t.state.phrase("go"))),pos:-10}}"undefined"!=typeof Symbol&&(x.prototype[Symbol.iterator]=C.prototype[Symbol.iterator]=function(){return this});const A=r.Py.define(),M=r.QQ.define({create:()=>!0,update(t,e){for(let i of e.effects)i.is(A)&&(t=i.value);return t},provide:t=>u.from(t,(t=>t?S:null))}),T=n.tk.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),P={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100},L=r.r$.define({combine:t=>(0,r.BO)(t,P,{highlightWordAroundCursor:(t,e)=>t||e,minSelectionLength:Math.min,maxMatches:Math.min})});function O(t){let e=[E,N];return t&&e.push(L.of(t)),e}const B=n.p.mark({class:"cm-selectionMatch"}),D=n.p.mark({class:"cm-selectionMatch cm-selectionMatch-main"}),N=n.lg.fromClass(class{constructor(t){this.decorations=this.getDeco(t)}update(t){(t.selectionSet||t.docChanged||t.viewportChanged)&&(this.decorations=this.getDeco(t.view))}getDeco(t){let e=t.state.facet(L),{state:i}=t,s=i.selection;if(s.ranges.length>1)return n.p.none;let o,l=s.main,a=null;if(l.empty){if(!e.highlightWordAroundCursor)return n.p.none;let t=i.wordAt(l.head);if(!t)return n.p.none;a=i.charCategorizer(l.head),o=i.sliceDoc(t.from,t.to)}else{let t=l.to-l.from;if(t<e.minSelectionLength||t>200)return n.p.none;if(o=i.sliceDoc(l.from,l.to).trim(),!o)return n.p.none}let h=[];for(let s of t.visibleRanges){let t=new b(i.doc,o,s.from,s.to);for(;!t.next().done;){let{from:s,to:o}=t.value;if((!a||(0==s||a(i.sliceDoc(s-1,s))!=r.D0.Word)&&(o==i.doc.length||a(i.sliceDoc(o,o+1))!=r.D0.Word))&&(a&&s<=l.from&&o>=l.to?h.push(D.range(s,o)):(s>=l.to||o<=l.from)&&h.push(B.range(s,o)),h.length>e.maxMatches))return n.p.none}}return n.p.set(h)}},{decorations:t=>t.decorations}),E=n.tk.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}});const R=r.r$.define({combine(t){var e;return{top:t.reduce(((t,e)=>null!=t?t:e.top),void 0)||!1,caseSensitive:t.reduce(((t,e)=>null!=t?t:e.caseSensitive||e.matchCase),void 0)||!1,createPanel:(null===(e=t.find((t=>t.createPanel)))||void 0===e?void 0:e.createPanel)||(t=>new rt(t))}}});class I{constructor(t){this.search=t.search,this.caseSensitive=!!t.caseSensitive,this.regexp=!!t.regexp,this.replace=t.replace||"",this.valid=!!this.search&&(!this.regexp||function(t){try{return new RegExp(t,y),!0}catch(t){return!1}}(this.search))}eq(t){return this.search==t.search&&this.replace==t.replace&&this.caseSensitive==t.caseSensitive&&this.regexp==t.regexp}create(){return this.regexp?new z(this):new j(this)}}class q{constructor(t){this.spec=t}}class j extends q{constructor(t){super(t),this.unquoted=t.search.replace(/\\([nrt\\])/g,((t,e)=>"n"==e?"\n":"r"==e?"\r":"t"==e?"\t":"\\"))}cursor(t,e=0,i=t.length){return new b(t,this.unquoted,e,i,this.spec.caseSensitive?void 0:t=>t.toLowerCase())}nextMatch(t,e,i){let n=this.cursor(t,i).nextOverlapping();return n.done&&(n=this.cursor(t,0,e).nextOverlapping()),n.done?null:n.value}prevMatchInRange(t,e,i){for(let n=i;;){let i=Math.max(e,n-1e4-this.unquoted.length),r=this.cursor(t,i,n),s=null;for(;!r.nextOverlapping().done;)s=r.value;if(s)return s;if(i==e)return null;n-=1e4}}prevMatch(t,e,i){return this.prevMatchInRange(t,0,e)||this.prevMatchInRange(t,i,t.length)}getReplacement(t){return this.spec.replace}matchAll(t,e){let i=this.cursor(t),n=[];for(;!i.next().done;){if(n.length>=e)return null;n.push(i.value)}return n}highlight(t,e,i,n){let r=this.cursor(t,Math.max(0,e-this.unquoted.length),Math.min(i+this.unquoted.length,t.length));for(;!r.next().done;)n(r.value.from,r.value.to)}}class z extends q{cursor(t,e=0,i=t.length){return new x(t,this.spec.search,this.spec.caseSensitive?void 0:{ignoreCase:!0},e,i)}nextMatch(t,e,i){let n=this.cursor(t,i).next();return n.done&&(n=this.cursor(t,0,e).next()),n.done?null:n.value}prevMatchInRange(t,e,i){for(let n=1;;n++){let r=Math.max(e,i-1e4*n),s=this.cursor(t,r,i),o=null;for(;!s.next().done;)o=s.value;if(o&&(r==e||o.from>r+10))return o;if(r==e)return null}}prevMatch(t,e,i){return this.prevMatchInRange(t,0,e)||this.prevMatchInRange(t,i,t.length)}getReplacement(t){return this.spec.replace.replace(/\$([$&\d+])/g,((e,i)=>"$"==i?"$":"&"==i?t.match[0]:"0"!=i&&+i<t.match.length?t.match[i]:e))}matchAll(t,e){let i=this.cursor(t),n=[];for(;!i.next().done;){if(n.length>=e)return null;n.push(i.value)}return n}highlight(t,e,i,n){let r=this.cursor(t,Math.max(0,e-250),Math.min(i+250,t.length));for(;!r.next().done;)n(r.value.from,r.value.to)}}const _=r.Py.define(),V=r.Py.define(),$=r.QQ.define({create:t=>new F(tt(t).create(),Y),update(t,e){for(let i of e.effects)i.is(_)?t=new F(i.value.create(),t.panel):i.is(V)&&(t=new F(t.query,i.value?Y:null));return t},provide:t=>u.from(t,(t=>t.panel))});class F{constructor(t,e){this.query=t,this.panel=e}}const W=n.p.mark({class:"cm-searchMatch"}),U=n.p.mark({class:"cm-searchMatch cm-searchMatch-selected"}),H=n.lg.fromClass(class{constructor(t){this.view=t,this.decorations=this.highlight(t.state.field($))}update(t){let e=t.state.field($);(e!=t.startState.field($)||t.docChanged||t.selectionSet)&&(this.decorations=this.highlight(e))}highlight({query:t,panel:e}){if(!e||!t.spec.valid)return n.p.none;let{view:i}=this,r=new f.f_;for(let e=0,n=i.visibleRanges,s=n.length;e<s;e++){let{from:o,to:l}=n[e];for(;e<s-1&&l>n[e+1].from-500;)l=n[++e].to;t.highlight(i.state.doc,o,l,((t,e)=>{let n=i.state.selection.ranges.some((i=>i.from==t&&i.to==e));r.add(t,e,n?U:W)}))}return r.finish()}},{decorations:t=>t.decorations});function G(t){return e=>{let i=e.state.field($,!1);return i&&i.query.spec.valid?t(e,i):et(e)}}const Q=G(((t,{query:e})=>{let{from:i,to:n}=t.state.selection.main,r=e.nextMatch(t.state.doc,i,n);return!(!r||r.from==i&&r.to==n)&&(t.dispatch({selection:{anchor:r.from,head:r.to},scrollIntoView:!0,effects:lt(t,r),userEvent:"select.search"}),!0)})),K=G(((t,{query:e})=>{let{state:i}=t,{from:n,to:r}=i.selection.main,s=e.prevMatch(i.doc,n,r);return!!s&&(t.dispatch({selection:{anchor:s.from,head:s.to},scrollIntoView:!0,effects:lt(t,s),userEvent:"select.search"}),!0)})),J=G(((t,{query:e})=>{let i=e.matchAll(t.state.doc,1e3);return!(!i||!i.length)&&(t.dispatch({selection:r.jT.create(i.map((t=>r.jT.range(t.from,t.to)))),userEvent:"select.search.matches"}),!0)})),Z=G(((t,{query:e})=>{let{state:i}=t,{from:n,to:r}=i.selection.main;if(i.readOnly)return!1;let s=e.nextMatch(i.doc,n,n);if(!s)return!1;let o,l,a=[];if(s.from==n&&s.to==r&&(l=i.toText(e.getReplacement(s)),a.push({from:s.from,to:s.to,insert:l}),s=e.nextMatch(i.doc,s.from,s.to)),s){let t=0==a.length||a[0].from>=s.to?0:s.to-s.from-l.length;o={anchor:s.from-t,head:s.to-t}}return t.dispatch({changes:a,selection:o,scrollIntoView:!!o,effects:s?lt(t,s):void 0,userEvent:"input.replace"}),!0})),X=G(((t,{query:e})=>{if(t.state.readOnly)return!1;let i=e.matchAll(t.state.doc,1e9).map((t=>{let{from:i,to:n}=t;return{from:i,to:n,insert:e.getReplacement(t)}}));return!!i.length&&(t.dispatch({changes:i,userEvent:"input.replace.all"}),!0)}));function Y(t){return t.state.facet(R).createPanel(t)}function tt(t,e){var i;let n=t.selection.main,r=n.empty||n.to>n.from+100?"":t.sliceDoc(n.from,n.to),s=null!==(i=null==e?void 0:e.caseSensitive)&&void 0!==i?i:t.facet(R).caseSensitive;return e&&!r?e:new I({search:r.replace(/\n/g,"\\n"),caseSensitive:s})}const et=t=>{let e=t.state.field($,!1);if(e&&e.panel){let i=o(t,Y);if(!i)return!1;let n=i.dom.querySelector("[name=search]");if(n!=t.root.activeElement){let i=tt(t.state,e.query.spec);i.valid&&t.dispatch({effects:_.of(i)}),n.focus(),n.select()}}else t.dispatch({effects:[V.of(!0),e?_.of(tt(t.state,e.query.spec)):r.Py.appendConfig.of(ht)]});return!0},it=t=>{let e=t.state.field($,!1);if(!e||!e.panel)return!1;let i=o(t,Y);return i&&i.dom.contains(t.root.activeElement)&&t.focus(),t.dispatch({effects:V.of(!1)}),!0},nt=[{key:"Mod-f",run:et,scope:"editor search-panel"},{key:"F3",run:Q,shift:K,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:Q,shift:K,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:it,scope:"editor search-panel"},{key:"Mod-Shift-l",run:({state:t,dispatch:e})=>{let i=t.selection;if(i.ranges.length>1||i.main.empty)return!1;let{from:n,to:s}=i.main,o=[],l=0;for(let e=new b(t.doc,t.sliceDoc(n,s));!e.next().done;){if(o.length>1e3)return!1;e.value.from==n&&(l=o.length),o.push(r.jT.range(e.value.from,e.value.to))}return e(t.update({selection:r.jT.create(o,l),userEvent:"select.search.matches"})),!0}},{key:"Alt-g",run:t=>{let e=o(t,S);if(!e){let i=[A.of(!0)];null==t.state.field(M,!1)&&i.push(r.Py.appendConfig.of([M,T])),t.dispatch({effects:i}),e=o(t,S)}return e&&e.dom.querySelector("input").focus(),!0}},{key:"Mod-d",run:({state:t,dispatch:e})=>{let{ranges:i}=t.selection;if(i.some((t=>t.from===t.to)))return(({state:t,dispatch:e})=>{let{selection:i}=t,n=r.jT.create(i.ranges.map((e=>t.wordAt(e.head)||r.jT.cursor(e.head))),i.mainIndex);return!n.eq(i)&&(e(t.update({selection:n})),!0)})({state:t,dispatch:e});let s=t.sliceDoc(i[0].from,i[0].to);if(t.selection.ranges.some((e=>t.sliceDoc(e.from,e.to)!=s)))return!1;let o=function(t,e){let{main:i,ranges:n}=t.selection,r=t.wordAt(i.head),s=r&&r.from==i.from&&r.to==i.to;for(let i=!1,r=new b(t.doc,e,n[n.length-1].to);;){if(r.next(),!r.done){if(i&&n.some((t=>t.from==r.value.from)))continue;if(s){let e=t.wordAt(r.value.from);if(!e||e.from!=r.value.from||e.to!=r.value.to)continue}return r.value}if(i)return null;r=new b(t.doc,e,0,Math.max(0,n[n.length-1].from-1)),i=!0}}(t,s);return!!o&&(e(t.update({selection:t.selection.addRange(r.jT.range(o.from,o.to),!1),effects:n.tk.scrollIntoView(o.to)})),!0)},preventDefault:!0}];class rt{constructor(t){this.view=t;let e=this.query=t.state.field($).query.spec;function i(t,e,i){return p("button",{class:"cm-button",name:t,onclick:e,type:"button"},i)}this.commit=this.commit.bind(this),this.searchField=p("input",{value:e.search,placeholder:st(t,"Find"),"aria-label":st(t,"Find"),class:"cm-textfield",name:"search",onchange:this.commit,onkeyup:this.commit}),this.replaceField=p("input",{value:e.replace,placeholder:st(t,"Replace"),"aria-label":st(t,"Replace"),class:"cm-textfield",name:"replace",onchange:this.commit,onkeyup:this.commit}),this.caseField=p("input",{type:"checkbox",name:"case",checked:e.caseSensitive,onchange:this.commit}),this.reField=p("input",{type:"checkbox",name:"re",checked:e.regexp,onchange:this.commit}),this.dom=p("div",{onkeydown:t=>this.keydown(t),class:"cm-search"},[this.searchField,i("next",(()=>Q(t)),[st(t,"next")]),i("prev",(()=>K(t)),[st(t,"previous")]),i("select",(()=>J(t)),[st(t,"all")]),p("label",null,[this.caseField,st(t,"match case")]),p("label",null,[this.reField,st(t,"regexp")]),...t.state.readOnly?[]:[p("br"),this.replaceField,i("replace",(()=>Z(t)),[st(t,"replace")]),i("replaceAll",(()=>X(t)),[st(t,"replace all")]),p("button",{name:"close",onclick:()=>it(t),"aria-label":st(t,"close"),type:"button"},["×"])]])}commit(){let t=new I({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,replace:this.replaceField.value});t.eq(this.query)||(this.query=t,this.view.dispatch({effects:_.of(t)}))}keydown(t){(0,n.$1)(this.view,t,"search-panel")?t.preventDefault():13==t.keyCode&&t.target==this.searchField?(t.preventDefault(),(t.shiftKey?K:Q)(this.view)):13==t.keyCode&&t.target==this.replaceField&&(t.preventDefault(),Z(this.view))}update(t){for(let e of t.transactions)for(let t of e.effects)t.is(_)&&!t.value.eq(this.query)&&this.setQuery(t.value)}setQuery(t){this.query=t,this.searchField.value=t.search,this.replaceField.value=t.replace,this.caseField.checked=t.caseSensitive,this.reField.checked=t.regexp}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(R).top}}function st(t,e){return t.state.phrase(e)}const ot=/[\s\.,:;?!]/;function lt(t,{from:e,to:i}){let r=t.state.doc.lineAt(e).from,s=t.state.doc.lineAt(i).to,o=Math.max(r,e-30),l=Math.min(s,i+30),a=t.state.sliceDoc(o,l);if(o!=r)for(let t=0;t<30;t++)if(!ot.test(a[t+1])&&ot.test(a[t])){a=a.slice(t);break}if(l!=s)for(let t=a.length-1;t>a.length-30;t--)if(!ot.test(a[t-1])&&ot.test(a[t])){a=a.slice(0,t);break}return n.tk.announce.of(`${t.state.phrase("current match")}. ${a} ${t.state.phrase("on line")} ${t.state.doc.lineAt(e).number}`)}const at=n.tk.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),ht=[$,r.Wl.lowest(H),at]},67545:(t,e,i)=>{i.d(e,{i:()=>h});var n=i(97248),r=i(42484),s=i(25070);function o(t,e,i,n=0,r=0){null==e&&-1==(e=t.search(/[^\s\u00a0]/))&&(e=t.length);let s=r;for(let r=n;r<e;r++)9==t.charCodeAt(r)?s+=i-s%i:s++;return s}class l{constructor(t,e,i){this.string=t,this.tabSize=e,this.indentUnit=i,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return 0==this.pos}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(t){let e,i=this.string.charAt(this.pos);if(e="string"==typeof t?i==t:i&&(t instanceof RegExp?t.test(i):t(i)),e)return++this.pos,i}eatWhile(t){let e=this.pos;for(;this.eat(t););return this.pos>e}eatSpace(){let t=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>t}skipToEnd(){this.pos=this.string.length}skipTo(t){let e=this.string.indexOf(t,this.pos);if(e>-1)return this.pos=e,!0}backUp(t){this.pos-=t}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=o(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){return o(this.string,null,this.tabSize)}match(t,e,i){if("string"==typeof t){let n=t=>i?t.toLowerCase():t;return n(this.string.substr(this.pos,t.length))==n(t)?(!1!==e&&(this.pos+=t.length),!0):null}{let i=this.string.slice(this.pos).match(t);return i&&i.index>0?null:(i&&!1!==e&&(this.pos+=i[0].length),i)}}current(){return this.string.slice(this.start,this.pos)}}function a(t){if("object"!=typeof t)return t;let e={};for(let i in t){let n=t[i];e[i]=n instanceof Array?n.slice():n}return e}class h extends s.SQ{constructor(t){let e,i=(0,s.kU)(t.languageData),r={token:(o=t).token,blankLine:o.blankLine||(()=>{}),startState:o.startState||(()=>!0),copyState:o.copyState||a,indent:o.indent||(()=>null),languageData:o.languageData||{},tokenTable:o.tokenTable||d};var o;super(i,new class extends n._b{createParse(t,i,n){return new f(e,t,i,n)}},function(t){let e=n.Jq.define({id:m.length,name:"Document",props:[s.mi.add((()=>t))]});return m.push(e),e}(i),[s.tK.of(((t,e)=>this.getIndent(t,e)))]),e=this,this.streamParser=r,this.stateAfter=new n.md({perNode:!0}),this.tokenTable=t.tokenTable?new y(r.tokenTable):x}static define(t){return new h(t)}getIndent(t,e){let i=(0,s.qz)(t.state),n=i.resolve(e);for(;n&&n.type!=this.topNode;)n=n.parent;if(!n)return null;let r,o,a=c(this,i,0,n.from,e);if(a?(o=a.state,r=a.pos+1):(o=this.streamParser.startState(t.unit),r=0),e-r>1e4)return null;for(;r<e;){let i=t.state.doc.lineAt(r),n=Math.min(e,i.to);if(i.length){let e=new l(i.text,t.state.tabSize,t.unit);for(;e.pos<n-i.from;)p(this.streamParser.token,e,o)}else this.streamParser.blankLine(o,t.unit);if(n==e)break;r=i.to+1}let{text:h}=t.state.doc.lineAt(e);return this.streamParser.indent(o,/^\s*(.*)/.exec(h)[1],t)}get allowsNesting(){return!1}}function c(t,e,i,r,s){let o=i>=r&&i+e.length<=s&&e.prop(t.stateAfter);if(o)return{state:t.streamParser.copyState(o),pos:i+e.length};for(let o=e.children.length-1;o>=0;o--){let l=e.children[o],a=i+e.positions[o],h=l instanceof n.mp&&a<s&&c(t,l,a,r,s);if(h)return h}return null}function u(t,e,i,r,s){if(s&&i<=0&&r>=e.length)return e;s||e.type!=t.topNode||(s=!0);for(let o=e.children.length-1;o>=0;o--){let l,a=e.positions[o],h=e.children[o];if(a<r&&h instanceof n.mp){if(!(l=u(t,h,i-a,r-a,s)))break;return s?new n.mp(e.type,e.children.slice(0,o).concat(l),e.positions.slice(0,o+1),a+l.length):l}}return null}class f{constructor(t,e,i,r){this.lang=t,this.input=e,this.fragments=i,this.ranges=r,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=r[r.length-1].to;let o=s.Be.get(),l=r[0].from,{state:a,tree:h}=function(t,e,i,r){for(let n of e){let e,r=n.from+(n.openStart?25:0),s=n.to-(n.openEnd?25:0),o=r<=i&&s>i&&c(t,n.tree,0-n.offset,i,s);if(o&&(e=u(t,n.tree,i+n.offset,o.pos+n.offset,!1)))return{state:o.state,tree:e}}return{state:t.streamParser.startState(r?(0,s.y1)(r):4),tree:n.mp.empty}}(t,i,l,null==o?void 0:o.state);this.state=a,this.parsedPos=this.chunkStart=l+h.length;for(let t=0;t<h.children.length;t++)this.chunks.push(h.children[t]),this.chunkPos.push(h.positions[t]);o&&this.parsedPos<o.viewport.from-1e5&&(this.state=this.lang.streamParser.startState((0,s.y1)(o.state)),o.skipUntilInView(this.parsedPos,o.viewport.from),this.parsedPos=o.viewport.from)}advance(){let t=s.Be.get(),e=null==this.stoppedAt?this.to:this.stoppedAt,i=Math.min(e,this.chunkStart+2048);for(t&&(i=Math.min(i,t.viewport.to));this.parsedPos<i;)this.parseLine(t);return this.chunkStart<this.parsedPos&&this.finishChunk(),this.parsedPos>=e?this.finish():t&&this.parsedPos>=t.viewport.to?(t.skipUntilInView(this.parsedPos,e),this.finish()):null}stopAt(t){this.stoppedAt=t}lineAfter(t){let e=this.input.chunk(t);if(this.input.lineChunks)"\n"==e&&(e="");else{let t=e.indexOf("\n");t>-1&&(e=e.slice(0,t))}return t+e.length<=this.to?e:e.slice(0,this.to-t)}nextLine(){let t=this.parsedPos,e=this.lineAfter(t),i=t+e.length;for(let t=this.rangeIndex;;){let n=this.ranges[t].to;if(n>=i)break;if(e=e.slice(0,n-(i-e.length)),t++,t==this.ranges.length)break;let r=this.ranges[t].from,s=this.lineAfter(r);e+=s,i=r+s.length}return{line:e,end:i}}skipGapsTo(t,e,i){for(;;){let n=this.ranges[this.rangeIndex].to,r=t+e;if(i>0?n>r:n>=r)break;e+=this.ranges[++this.rangeIndex].from-n}return e}emitToken(t,e,i,n,r){if(this.ranges.length>1){e+=r=this.skipGapsTo(e,r,1);let t=this.chunk.length;i+=r=this.skipGapsTo(i,r,-1),n+=this.chunk.length-t}return this.chunk.push(t,e,i,n),r}parseLine(t){let{line:e,end:i}=this.nextLine(),n=0,{streamParser:r}=this.lang,o=new l(e,t?t.state.tabSize:4,t?(0,s.y1)(t.state):2);if(o.eol())r.blankLine(this.state,o.indentUnit);else for(;!o.eol();){let t=p(r.token,o,this.state);if(t&&(n=this.emitToken(this.lang.tokenTable.resolve(t),this.parsedPos+o.start,this.parsedPos+o.pos,4,n)),o.start>1e4)break}this.parsedPos=i,this.parsedPos<this.to&&this.parsedPos++}finishChunk(){let t=n.mp.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:g,topID:0,maxBufferLength:2048,reused:this.chunkReused});t=new n.mp(t.type,t.children,t.positions,t.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]),this.chunks.push(t),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}finish(){return new n.mp(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}}function p(t,e,i){e.start=e.pos;for(let n=0;n<10;n++){let n=t(e,i);if(e.pos>e.start)return n}throw new Error("Stream parser failed to advance stream.")}const d=Object.create(null),m=[n.Jq.none],g=new n.Lj(m),b=[],v=Object.create(null);for(let[t,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","typeName"],["attribute","propertyName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])v[t]=k(d,e);class y{constructor(t){this.extra=t,this.table=Object.assign(Object.create(null),v)}resolve(t){return t?this.table[t]||(this.table[t]=k(this.extra,t)):0}}const x=new y(d);function w(t,e){b.indexOf(t)>-1||(b.push(t),console.warn(e))}function k(t,e){let i=null;for(let n of e.split(".")){let e=t[n]||r.pJ[n];e?"function"==typeof e?i?i=e(i):w(n,`Modifier ${n} used at start of tag`):i?w(n,`Tag ${n} used as modifier`):i=e:w(n,`Unknown highlighting tag ${n}`)}if(!i)return 0;let s=e.replace(/ /g,"_"),o=n.Jq.define({id:m.length,name:s,props:[(0,r.Gv)({[s]:i})]});return m.push(o),o.id}},97248:(t,e,i)=>{i.d(e,{md:()=>o,Lj:()=>h,Jq:()=>a,_b:()=>A,mp:()=>u,i9:()=>S});const n=1024;let r=0;class s{constructor(t,e){this.from=t,this.to=e}}class o{constructor(t={}){this.id=r++,this.perNode=!!t.perNode,this.deserialize=t.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(t){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return"function"!=typeof t&&(t=a.match(t)),e=>{let i=t(e);return void 0===i?null:[this,i]}}}o.closedBy=new o({deserialize:t=>t.split(" ")}),o.openedBy=new o({deserialize:t=>t.split(" ")}),o.group=new o({deserialize:t=>t.split(" ")}),o.contextHash=new o({perNode:!0}),o.lookAhead=new o({perNode:!0}),o.mounted=new o({perNode:!0});const l=Object.create(null);class a{constructor(t,e,i,n=0){this.name=t,this.props=e,this.id=i,this.flags=n}static define(t){let e=t.props&&t.props.length?Object.create(null):l,i=(t.top?1:0)|(t.skipped?2:0)|(t.error?4:0)|(null==t.name?8:0),n=new a(t.name||"",e,t.id,i);if(t.props)for(let i of t.props)if(Array.isArray(i)||(i=i(n)),i){if(i[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");e[i[0].id]=i[1]}return n}prop(t){return this.props[t.id]}get isTop(){return(1&this.flags)>0}get isSkipped(){return(2&this.flags)>0}get isError(){return(4&this.flags)>0}get isAnonymous(){return(8&this.flags)>0}is(t){if("string"==typeof t){if(this.name==t)return!0;let e=this.prop(o.group);return!!e&&e.indexOf(t)>-1}return this.id==t}static match(t){let e=Object.create(null);for(let i in t)for(let n of i.split(" "))e[n]=t[i];return t=>{for(let i=t.prop(o.group),n=-1;n<(i?i.length:0);n++){let r=e[n<0?t.name:i[n]];if(r)return r}}}}a.none=new a("",Object.create(null),0,8);class h{constructor(t){this.types=t;for(let e=0;e<t.length;e++)if(t[e].id!=e)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...t){let e=[];for(let i of this.types){let n=null;for(let e of t){let t=e(i);t&&(n||(n=Object.assign({},i.props)),n[t[0].id]=t[1])}e.push(n?new a(i.name,n,i.id,i.flags):i)}return new h(e)}}const c=new WeakMap;class u{constructor(t,e,i,n,r){if(this.type=t,this.children=e,this.positions=i,this.length=n,this.props=null,r&&r.length){this.props=Object.create(null);for(let[t,e]of r)this.props["number"==typeof t?t:t.id]=e}}toString(){let t=this.prop(o.mounted);if(t&&!t.overlay)return t.tree.toString();let e="";for(let t of this.children){let i=t.toString();i&&(e&&(e+=","),e+=i)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(e.length?"("+e+")":""):e}cursor(t,e=0){let i=null!=t&&c.get(this)||this.topNode,n=new y(i);return null!=t&&(n.moveTo(t,e),c.set(this,n._tree)),n}fullCursor(){return new y(this.topNode,1)}get topNode(){return new m(this,0,0,null)}resolve(t,e=0){return this.cursor(t,e).node}resolveInner(t,e=0){let i=this.topNode;for(;;){let n=i.enter(t,e);if(!n)return i;i=n}}iterate(t){let{enter:e,leave:i,from:n=0,to:r=this.length}=t;for(let t=this.cursor(),s=()=>t.node;;){let o=!1;if(t.from<=r&&t.to>=n&&(t.type.isAnonymous||!1!==e(t.type,t.from,t.to,s))){if(t.firstChild())continue;t.type.isAnonymous||(o=!0)}for(;o&&i&&i(t.type,t.from,t.to,s),o=t.type.isAnonymous,!t.nextSibling();){if(!t.parent())return;o=!0}}}prop(t){return t.perNode?this.props?this.props[t.id]:void 0:this.type.prop(t)}get propValues(){let t=[];if(this.props)for(let e in this.props)t.push([+e,this.props[e]]);return t}balance(t={}){return this.children.length<=8?this:C(this.type,this.children,this.positions,0,this.children.length,0,this.length,((t,e,i)=>new u(this.type,t,e,i,this.propValues)),t.makeTree||((t,e,i)=>new u(a.none,t,e,i)))}static build(t){return function(t){var e;let{buffer:i,nodeSet:r,maxBufferLength:s=n,reused:l=[],minRepeatType:a=r.types.length}=t,h=Array.isArray(i)?new f(i,i.length):i,c=r.types,d=0,m=0;function g(t,e,i,n,o){let{id:u,start:f,end:k,size:S}=h,A=m;for(;S<0;){if(h.next(),-1==S){let e=l[u];return i.push(e),void n.push(f-t)}if(-3==S)return void(d=u);if(-4==S)return void(m=u);throw new RangeError(`Unrecognized record size: ${S}`)}let M,T,P=c[u],L=f-t;if(k-f<=s&&(T=x(h.pos-e,o))){let e=new Uint16Array(T.size-T.skip),i=h.pos-T.size,n=e.length;for(;h.pos>i;)n=w(T.start,e,n);M=new p(e,k-T.start,r),L=T.start-t}else{let t=h.pos-S;h.next();let e=[],i=[],n=u>=a?u:-1,r=0,o=k;for(;h.pos>t;)n>=0&&h.id==n&&h.size>=0?(h.end<=o-s&&(v(e,i,f,r,h.end,o,n,A),r=e.length,o=h.end),h.next()):g(f,t,e,i,n);if(n>=0&&r>0&&r<e.length&&v(e,i,f,r,f,o,n,A),e.reverse(),i.reverse(),n>-1&&r>0){let t=b(P);M=C(P,e,i,0,e.length,0,k-f,t,t)}else M=y(P,e,i,k-f,A-k)}i.push(M),n.push(L)}function b(t){return(e,i,n)=>{let r,s,l=0,a=e.length-1;if(a>=0&&(r=e[a])instanceof u){if(!a&&r.type==t&&r.length==n)return r;(s=r.prop(o.lookAhead))&&(l=i[a]+r.length+s)}return y(t,e,i,n,l)}}function v(t,e,i,n,s,o,l,a){let h=[],c=[];for(;t.length>n;)h.push(t.pop()),c.push(e.pop()+i-s);t.push(y(r.types[l],h,c,o-s,a-o)),e.push(s-i)}function y(t,e,i,n,r=0,s){if(d){let t=[o.contextHash,d];s=s?[t].concat(s):[t]}if(r>25){let t=[o.lookAhead,r];s=s?[t].concat(s):[t]}return new u(t,e,i,n,s)}function x(t,e){let i=h.fork(),n=0,r=0,o=0,l=i.end-s,c={size:0,start:0,skip:0};t:for(let s=i.pos-t;i.pos>s;){let t=i.size;if(i.id==e&&t>=0){c.size=n,c.start=r,c.skip=o,o+=4,n+=4,i.next();continue}let h=i.pos-t;if(t<0||h<s||i.start<l)break;let u=i.id>=a?4:0,f=i.start;for(i.next();i.pos>h;){if(i.size<0){if(-3!=i.size)break t;u+=4}else i.id>=a&&(u+=4);i.next()}r=f,n+=t,o+=u}return(e<0||n==t)&&(c.size=n,c.start=r,c.skip=o),c.size>4?c:void 0}function w(t,e,i){let{id:n,start:r,end:s,size:o}=h;if(h.next(),o>=0&&n<a){let l=i;if(o>4){let n=h.pos-(o-4);for(;h.pos>n;)i=w(t,e,i)}e[--i]=l,e[--i]=s-t,e[--i]=r-t,e[--i]=n}else-3==o?d=n:-4==o&&(m=n);return i}let k=[],S=[];for(;h.pos>0;)g(t.start||0,t.bufferStart||0,k,S,-1);let A=null!==(e=t.length)&&void 0!==e?e:k.length?S[0]+k[0].length:0;return new u(c[t.topID],k.reverse(),S.reverse(),A)}(t)}}u.empty=new u(a.none,[],[],0);class f{constructor(t,e){this.buffer=t,this.index=e}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new f(this.buffer,this.index)}}class p{constructor(t,e,i){this.buffer=t,this.length=e,this.set=i}get type(){return a.none}toString(){let t=[];for(let e=0;e<this.buffer.length;)t.push(this.childString(e)),e=this.buffer[e+3];return t.join(",")}childString(t){let e=this.buffer[t],i=this.buffer[t+3],n=this.set.types[e],r=n.name;if(/\W/.test(r)&&!n.isError&&(r=JSON.stringify(r)),i==(t+=4))return r;let s=[];for(;t<i;)s.push(this.childString(t)),t=this.buffer[t+3];return r+"("+s.join(",")+")"}findChild(t,e,i,n,r){let{buffer:s}=this,o=-1;for(let l=t;l!=e&&!(d(r,n,s[l+1],s[l+2])&&(o=l,i>0));l=s[l+3]);return o}slice(t,e,i,n){let r=this.buffer,s=new Uint16Array(e-t);for(let n=t,o=0;n<e;)s[o++]=r[n++],s[o++]=r[n++]-i,s[o++]=r[n++]-i,s[o++]=r[n++]-t;return new p(s,n-i,this.set)}}function d(t,e,i,n){switch(t){case-2:return i<e;case-1:return n>=e&&i<e;case 0:return i<e&&n>e;case 1:return i<=e&&n>e;case 2:return n>e;case 4:return!0}}class m{constructor(t,e,i,n){this.node=t,this._from=e,this.index=i,this._parent=n}get type(){return this.node.type}get name(){return this.node.type.name}get from(){return this._from}get to(){return this._from+this.node.length}nextChild(t,e,i,n,r=0){for(let s=this;;){for(let{children:l,positions:a}=s.node,h=e>0?l.length:-1;t!=h;t+=e){let h=l[t],c=a[t]+s._from;if(d(n,i,c,c+h.length))if(h instanceof p){if(2&r)continue;let o=h.findChild(0,h.buffer.length,e,i-c,n);if(o>-1)return new v(new b(s,h,t,c),null,o)}else if(1&r||!h.type.isAnonymous||x(h)){let l;if(h.props&&(l=h.prop(o.mounted))&&!l.overlay)return new m(l.tree,c,t,s);let a=new m(h,c,t,s);return 1&r||!a.type.isAnonymous?a:a.nextChild(e<0?h.children.length-1:0,e,i,n)}}if(1&r||!s.type.isAnonymous)return null;if(t=s.index>=0?s.index+e:e<0?-1:s._parent.node.children.length,s=s._parent,!s)return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this.node.children.length-1,-1,0,4)}childAfter(t){return this.nextChild(0,1,t,2)}childBefore(t){return this.nextChild(this.node.children.length-1,-1,t,-2)}enter(t,e,i=!0,n=!0){let r;if(i&&(r=this.node.prop(o.mounted))&&r.overlay){let i=t-this.from;for(let{from:t,to:n}of r.overlay)if((e>0?t<=i:t<i)&&(e<0?n>=i:n>i))return new m(r.tree,r.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,t,e,n?0:2)}nextSignificantParent(){let t=this;for(;t.type.isAnonymous&&t._parent;)t=t._parent;return t}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get cursor(){return new y(this)}get tree(){return this.node}toTree(){return this.node}resolve(t,e=0){return this.cursor.moveTo(t,e).node}getChild(t,e=null,i=null){let n=g(this,t,e,i);return n.length?n[0]:null}getChildren(t,e=null,i=null){return g(this,t,e,i)}toString(){return this.node.toString()}}function g(t,e,i,n){let r=t.cursor,s=[];if(!r.firstChild())return s;if(null!=i)for(;!r.type.is(i);)if(!r.nextSibling())return s;for(;;){if(null!=n&&r.type.is(n))return s;if(r.type.is(e)&&s.push(r.node),!r.nextSibling())return null==n?s:[]}}class b{constructor(t,e,i,n){this.parent=t,this.buffer=e,this.index=i,this.start=n}}class v{constructor(t,e,i){this.context=t,this._parent=e,this.index=i,this.type=t.buffer.set.types[t.buffer.buffer[i]]}get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}child(t,e,i){let{buffer:n}=this.context,r=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.context.start,i);return r<0?null:new v(this.context,this,r)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(t){return this.child(1,t,2)}childBefore(t){return this.child(-1,t,-2)}enter(t,e,i,n=!0){if(!n)return null;let{buffer:r}=this.context,s=r.findChild(this.index+4,r.buffer[this.index+3],e>0?1:-1,t-this.context.start,e);return s<0?null:new v(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(t){return this._parent?null:this.context.parent.nextChild(this.context.index+t,t,0,4)}get nextSibling(){let{buffer:t}=this.context,e=t.buffer[this.index+3];return e<(this._parent?t.buffer[this._parent.index+3]:t.buffer.length)?new v(this.context,this._parent,e):this.externalSibling(1)}get prevSibling(){let{buffer:t}=this.context,e=this._parent?this._parent.index+4:0;return this.index==e?this.externalSibling(-1):new v(this.context,this._parent,t.findChild(e,this.index,-1,0,4))}get cursor(){return new y(this)}get tree(){return null}toTree(){let t=[],e=[],{buffer:i}=this.context,n=this.index+4,r=i.buffer[this.index+3];if(r>n){let s=i.buffer[this.index+1],o=i.buffer[this.index+2];t.push(i.slice(n,r,s,o)),e.push(0)}return new u(this.type,t,e,this.to-this.from)}resolve(t,e=0){return this.cursor.moveTo(t,e).node}toString(){return this.context.buffer.childString(this.index)}getChild(t,e=null,i=null){let n=g(this,t,e,i);return n.length?n[0]:null}getChildren(t,e=null,i=null){return g(this,t,e,i)}}class y{constructor(t,e=0){if(this.mode=e,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,t instanceof m)this.yieldNode(t);else{this._tree=t.context.parent,this.buffer=t.context;for(let e=t._parent;e;e=e._parent)this.stack.unshift(e.index);this.bufferNode=t,this.yieldBuf(t.index)}}get name(){return this.type.name}yieldNode(t){return!!t&&(this._tree=t,this.type=t.type,this.from=t.from,this.to=t.to,!0)}yieldBuf(t,e){this.index=t;let{start:i,buffer:n}=this.buffer;return this.type=e||n.set.types[n.buffer[t]],this.from=i+n.buffer[t+1],this.to=i+n.buffer[t+2],!0}yield(t){return!!t&&(t instanceof m?(this.buffer=null,this.yieldNode(t)):(this.buffer=t.context,this.yieldBuf(t.index,t.type)))}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(t,e,i){if(!this.buffer)return this.yield(this._tree.nextChild(t<0?this._tree.node.children.length-1:0,t,e,i,this.mode));let{buffer:n}=this.buffer,r=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.buffer.start,i);return!(r<0)&&(this.stack.push(this.index),this.yieldBuf(r))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(t){return this.enterChild(1,t,2)}childBefore(t){return this.enterChild(-1,t,-2)}enter(t,e,i=!0,n=!0){return this.buffer?!!n&&this.enterChild(1,t,e):this.yield(this._tree.enter(t,e,i,n))}parent(){if(!this.buffer)return this.yieldNode(1&this.mode?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let t=1&this.mode?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(t)}sibling(t){if(!this.buffer)return!!this._tree._parent&&this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+t,t,0,4,this.mode));let{buffer:e}=this.buffer,i=this.stack.length-1;if(t<0){let t=i<0?0:this.stack[i]+4;if(this.index!=t)return this.yieldBuf(e.findChild(t,this.index,-1,0,4))}else{let t=e.buffer[this.index+3];if(t<(i<0?e.buffer.length:e.buffer[this.stack[i]+3]))return this.yieldBuf(t)}return i<0&&this.yield(this.buffer.parent.nextChild(this.buffer.index+t,t,0,4,this.mode))}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(t){let e,i,{buffer:n}=this;if(n){if(t>0){if(this.index<n.buffer.buffer.length)return!1}else for(let t=0;t<this.index;t++)if(n.buffer.buffer[t+3]<this.index)return!1;({index:e,parent:i}=n)}else({index:e,_parent:i}=this._tree);for(;i;({index:e,_parent:i}=i))if(e>-1)for(let n=e+t,r=t<0?-1:i.node.children.length;n!=r;n+=t){let t=i.node.children[n];if(1&this.mode||t instanceof p||!t.type.isAnonymous||x(t))return!1}return!0}move(t,e){if(e&&this.enterChild(t,0,4))return!0;for(;;){if(this.sibling(t))return!0;if(this.atLastNode(t)||!this.parent())return!1}}next(t=!0){return this.move(1,t)}prev(t=!0){return this.move(-1,t)}moveTo(t,e=0){for(;(this.from==this.to||(e<1?this.from>=t:this.from>t)||(e>-1?this.to<=t:this.to<t))&&this.parent(););for(;this.enterChild(1,t,e););return this}get node(){if(!this.buffer)return this._tree;let t=this.bufferNode,e=null,i=0;if(t&&t.context==this.buffer)t:for(let n=this.index,r=this.stack.length;r>=0;){for(let s=t;s;s=s._parent)if(s.index==n){if(n==this.index)return s;e=s,i=r+1;break t}n=this.stack[--r]}for(let t=i;t<this.stack.length;t++)e=new v(this.buffer,e,this.stack[t]);return this.bufferNode=new v(this.buffer,e,this.index)}get tree(){return this.buffer?null:this._tree.node}}function x(t){return t.children.some((t=>t instanceof p||!t.type.isAnonymous||x(t)))}const w=new WeakMap;function k(t,e){if(!t.isAnonymous||e instanceof p||e.type!=t)return 1;let i=w.get(e);return null==i&&(i=e.children.reduce(((e,i)=>e+k(t,i)),1),w.set(e,i)),i}function C(t,e,i,n,r,s,o,l,a){let h=0;for(let i=n;i<r;i++)h+=k(t,e[i]);let c=Math.ceil(1.5*h/8),u=[],f=[];return function e(i,n,r,o,l){for(let h=r;h<o;){let r=h,p=n[h],d=k(t,i[h]);for(h++;h<o;h++){let e=k(t,i[h]);if(d+e>=c)break;d+=e}if(h==r+1){if(d>c){let t=i[r];e(t.children,t.positions,0,t.children.length,n[r]+l);continue}u.push(i[r])}else{let e=n[h-1]+i[h-1].length-p;u.push(C(t,i,n,r,h,p,e,null,a))}f.push(p+l-s)}}(e,i,n,r,0),(l||a)(u,f,o)}class S{constructor(t,e,i,n,r=!1,s=!1){this.from=t,this.to=e,this.tree=i,this.offset=n,this.open=(r?1:0)|(s?2:0)}get openStart(){return(1&this.open)>0}get openEnd(){return(2&this.open)>0}static addTree(t,e=[],i=!1){let n=[new S(0,t.length,t,0,!1,i)];for(let i of e)i.to>t.length&&n.push(i);return n}static applyChanges(t,e,i=128){if(!e.length)return t;let n=[],r=1,s=t.length?t[0]:null;for(let o=0,l=0,a=0;;o++){let h=o<e.length?e[o]:null,c=h?h.fromA:1e9;if(c-l>=i)for(;s&&s.from<c;){let e=s;if(l>=e.from||c<=e.to||a){let t=Math.max(e.from,l)-a,i=Math.min(e.to,c)-a;e=t>=i?null:new S(t,i,e.tree,e.offset+a,o>0,!!h)}if(e&&n.push(e),s.to>c)break;s=r<t.length?t[r++]:null}if(!h)break;l=h.toA,a=h.toA-h.toB}return n}}class A{startParse(t,e,i){return"string"==typeof t&&(t=new M(t)),i=i?i.length?i.map((t=>new s(t.from,t.to))):[new s(0,0)]:[new s(0,t.length)],this.createParse(t,e||[],i)}parse(t,e,i){let n=this.startParse(t,e,i);for(;;){let t=n.advance();if(t)return t}}}class M{constructor(t){this.string=t}get length(){return this.string.length}chunk(t){return this.string.slice(t)}get lineChunks(){return!1}read(t,e){return this.string.slice(t,e)}}}}]);